<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Illustrating Cohen's d with ``superb`` • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Illustrating Cohen's d with ``superb``">
<meta property="og:description" content="This vignette shows how to illustrate Cohen's d with superb.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.95.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/Vignette1.html">Four steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Devising custom plot layouts</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Illustrating Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Illustrating Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Vignette9_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Illustrating Cohen’s d with <code>superb</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/master/../vignettes/Vignette9.Rmd"><code>../vignettes/Vignette9.Rmd</code></a></small>
      <div class="hidden name"><code>Vignette9.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we show how the Cohen’s <span class="math inline">\(d_p\)</span> can be illustrated. See <span class="citation">Goulet-Pelletier &amp; Cousineau (2018)</span>; <span class="citation">Cousineau &amp; Goulet-Pelletier (2020)</span> for comprehensive reviews.</p>
<div id="what-is-the-cohens-d_p" class="section level2">
<h2 class="hasAnchor">
<a href="#what-is-the-cohens-d_p" class="anchor"></a>What is the Cohen’s <span class="math inline">\(d_p\)</span>?</h2>
<p>The Cohen’s <span class="math inline">\(d_p\)</span>, also known as the <em>standardized mean difference</em> (smd), is a standardized measure of effect size for pairwise conditions. It is standardized using the standard deviation, so that it ressemble a <em>z</em> scores. Often, the sign of the Cohen’s <span class="math inline">\(d_p\)</span> is removed, but it could be positive or negative; it is not bounded but usually, it is smaller than 1.</p>
<p>As an example, a Cohen’s <span class="math inline">\(d_p\)</span> of 0.5 indicates that the two group’s means are separated by 0.5 standard deviations. If you illustrate the two populations with normal, bell-shape, curves, then their mode would be visibly separated, indicating a sizeable difference between the two populations. Cohen would call this a medium effect (although in my opinion, this is already a large effect; any non-trivially small samples would find this difference significant). With a Cohen’s <span class="math inline">\(d_p\)</span> of 0.25, it is harder to see a difference between the two populations.</p>
<p>This descriptive statistic is computed from two groups (or two repeated measures) with</p>
<p><span class="math display">\[
d_p = \frac{\vert \; M_1 - M_2 \; \vert}{S_p}
\]</span></p>
<p>where <span class="math inline">\(S_p\)</span> is the <em>pooled standard deviation</em> across the two group’s standard deviations.</p>
<p>Illustrating this measure with a plot is difficult as it is a pairwise statistic. For example, if there is 5 groups, that represents 15 <em>pairs</em> of groups and consequently, 15 Cohen’s <span class="math inline">\(d_p\)</span>.</p>
<p>Here, we propose an alternative representation through an indirect statistic, using <span class="math inline">\(d_1\)</span> <span class="citation">(Goulet-Pelletier &amp; Cousineau, 2018)</span>. It is given by</p>
<p><span class="math display">\[
d_1 = \frac{\vert \; M_1 - B \; \vert}{S_1}
\]</span></p>
<p>where <span class="math inline">\(S_1\)</span> is the standard deviation in the group (here labeled “1”). The quantity <span class="math inline">\(B\)</span> is a baseline measure. It can be any value based on prior knowledge of the measure (for example, if the measures are IQ, then <span class="math inline">\(B\)</span> would be set to 100). Alternatively, it can also be the <strong>grand mean</strong> across all the conditions. This is the solution we adopt herein.</p>
<p>The statistic <span class="math inline">\(d_1\)</span> is a univariate measure, i.e., it is based on a single group’s data. Hence, in a plot, you could illustrate one <span class="math inline">\(d_1\)</span> per group.</p>
<p>Why is it interesting? The point is that the difference between two <span class="math inline">\(d_1\)</span> is the Cohen’s <span class="math inline">\(d_p\)</span>! Likewise, the difference-adjusted confidence interval of <span class="math inline">\(d_1\)</span> is the same as the confidence interval of a Cohen’s <span class="math inline">\(d_p\)</span>. Hence, in a single plot, it is possible to derive all the Cohen’s <span class="math inline">\(d_p\)</span> and their significance.</p>
</div>
<div id="plotting-d_1-with-its-confidence-interval" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-d_1-with-its-confidence-interval" class="anchor"></a>Plotting <span class="math inline">\(d_1\)</span> with its confidence interval</h2>
<p>Let’s define this statistic and its confidence interval estimator:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/shabbychef/sadists">sadists</a></span><span class="op">)</span> <span class="co"># for computing confidence intervals of Cohen's d</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dcousin3.github.io/superb/">superb</a></span><span class="op">)</span>

<span class="va">d1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">{</span>
        <span class="co"># the global variable GM.d1 is obtained from the initializer</span>
        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">GM.d1</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> 
    <span class="op">}</span> 

<span class="va">CI.d1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">gamma</span> <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
    <span class="va">dlow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sadists/man/dlambdap.html">qlambdap</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span><span class="op">-</span><span class="fl">1</span>, t <span class="op">=</span> <span class="fu">d1</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">)</span> 
    <span class="va">dhig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sadists/man/dlambdap.html">qlambdap</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span><span class="op">-</span><span class="fl">1</span>, t <span class="op">=</span> <span class="fu">d1</span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">)</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dlow</span>, <span class="va">dhig</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>In that function, we have the variable <code>GM.d1</code> which represents the grand mean over all the condition. We see later how this variable is initialized.</p>
<p>In what follow, I use a randomly-generated data with <code><a href="../reference/GRD.html">GRD()</a></code> simulating three dosage levels in a between-group design. The three groups have different means of 50, 51.2 and 52.4 which should translate into observed <span class="math inline">\(d_p\)</span> of about 0.12 (between group 1 and group 2 as well as between group 2 and group 3) as the standard deviation in the population is 10:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># let's generate random data with true Cohen's dp </span>
<span class="co"># of 0.12 (groups 1 and 2) and 0.24 (groups 1 and 3)</span>
<span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GRD.html">GRD</a></span><span class="op">(</span> BSFactors <span class="op">=</span> <span class="st">"Dose(3)"</span>, 
    RenameDV          <span class="op">=</span> <span class="st">"score"</span>,
    Effects           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"Dose"</span> <span class="op">=</span> <span class="fu"><a href="../reference/slope.html">custom</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1.2</span>, <span class="fl">2.4</span><span class="op">)</span><span class="op">)</span>, 
    SubjectsPerGroup  <span class="op">=</span> <span class="fl">500</span>, 
    Population        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span> mean <span class="op">=</span> <span class="fl">50</span>, stddev <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<pre><code>## ------------------------------------------------------------ 
## Design is: 3 with 3 independent groups.
## ------------------------------------------------------------
## 1.Between-Subject Factors ( 3 groups ) :
##  Dose; levels: 1, 2, 3
## 2.Within-Subject Factors ( 1 repeated measures ):
## 3.Subjects per group ( 1500 total subjects ):
##   500
##  ------------------------------------------------------------</code></pre>
<p>If we set manually <code>GM.d1</code> to the grand mean, we are ready to make a plot. Alternatively, we can create an <strong>initializer</strong> that will be run by <code><a href="../reference/superbPlot.html">superbPlot()</a></code> automatically. Here it is:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the exact formulas for Cohen's d1 and dp. Only d1 is used in the plot</span>
<span class="va">init.d1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span> 
        <span class="va">GM.d1</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">DV</span><span class="op">)</span> <span class="co"># will make d1 relative to the grand mean</span>
<span class="op">}</span></code></pre></div>
<p>It will be run from the <code>rawData</code> data frame (generated by <code><a href="../reference/superbPlot.html">superbPlot()</a></code>; check <code><a href="../reference/superbData.html">superbData()</a></code> if you want to access that data frame) in which the measures are collated in the column <code>DV</code>.</p>
<p>Now let’s make the plot, feeding <code>d1</code> as the statistic function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># show a plot with Cohen's d1 and difference-adjusted confidence intervals of d1</span>
<span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, 
        BSFactors   <span class="op">=</span> <span class="st">"Dose"</span>, variables <span class="op">=</span> <span class="st">"score"</span>, 
        statistic   <span class="op">=</span> <span class="st">"d1"</span>,  errorbar  <span class="op">=</span> <span class="st">"CI"</span>, 
        gamma       <span class="op">=</span> <span class="fl">0.95</span>, 
        plotStyle   <span class="op">=</span> <span class="st">"line"</span>,
        adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span> 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="op">+</span><span class="fl">0.45</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"d_1 with difference-adjusted 95% confidence intervals of d_1"</span>,
     y     <span class="op">=</span> <span class="st">"d_1 relative to grand mean"</span><span class="op">)</span> </code></pre></div>
<pre><code>## superb::FYI: Running initializer init.d1</code></pre>
<div class="figure">
<img src="Vignette9_files/figure-html/unnamed-chunk-5-1.png" alt="**Figure 1**. d_1 scores along with 95% confidence interval." width="384"><p class="caption">
<strong>Figure 1</strong>. d_1 scores along with 95% confidence interval.
</p>
</div>
<p>The difference between two <span class="math inline">\(d_1\)</span> is the Cohen’s <span class="math inline">\(d_p\)</span> and the difference-adjusted confidence intervals are adequate to compare two <span class="math inline">\(d_p\)</span>. For example, the <span class="math inline">\(d_1\)</span> of the first group is not <strong>included</strong> in the third group’s <span class="math inline">\(d_1\)</span> which indicates that the Cohen’s <span class="math inline">\(d_p\)</span> is significantly different from zero.</p>
<p>Note that in the above, the initializer was detected and run automatically. You can check that the initializer is detectable with</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">superb</span><span class="fu">:::</span><span class="fu">has.init.function</span><span class="op">(</span><span class="st">"d1"</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="checking-the-results" class="section level2">
<h2 class="hasAnchor">
<a href="#checking-the-results" class="anchor"></a>Checking the results</h2>
<p>To check the above, we could implement the formulas for the Cohen’s <span class="math inline">\(d_p\)</span> <span class="citation">(Cousineau &amp; Goulet-Pelletier, 2020)</span>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> <span class="op">{</span>
        <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">X</span> <span class="op">-</span> <span class="va">Y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
    <span class="op">}</span> 
<span class="va">CI.dp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span>, <span class="va">gamma</span> <span class="op">=</span> <span class="fl">.95</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">n1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
    <span class="va">n2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>
    <span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="../reference/summaryStatistics.html">hmean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n1</span>, <span class="va">n2</span><span class="op">)</span><span class="op">)</span>
    <span class="va">dlow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sadists/man/dlambdap.html">qlambdap</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">-</span><span class="fl">2</span>, t <span class="op">=</span> <span class="fu">dp</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span> 
    <span class="va">dhig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sadists/man/dlambdap.html">qlambdap</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>, df <span class="op">=</span> <span class="va">n1</span><span class="op">+</span><span class="va">n2</span><span class="op">-</span><span class="fl">2</span>, t <span class="op">=</span> <span class="fu">dp</span><span class="op">(</span><span class="va">X</span>, <span class="va">Y</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dlow</span>, <span class="va">dhig</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Let’s extract the group’s data for intermediate computations:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">grp1</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dta</span><span class="op">$</span><span class="va">Dose</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>
<span class="va">grp2</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dta</span><span class="op">$</span><span class="va">Dose</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span>
<span class="va">grp3</span> <span class="op">&lt;-</span> <span class="va">dta</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dta</span><span class="op">$</span><span class="va">Dose</span><span class="op">==</span><span class="fl">3</span><span class="op">]</span></code></pre></div>
<p>so that we can easily compute all three pairwise statistics:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dp12</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">dp</span><span class="op">(</span><span class="va">grp2</span>, <span class="va">grp1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">dp13</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">dp</span><span class="op">(</span><span class="va">grp3</span>, <span class="va">grp1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">dp23</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">dp</span><span class="op">(</span><span class="va">grp3</span>, <span class="va">grp2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">dp12</span>, <span class="va">dp13</span>, <span class="va">dp23</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.133 0.290 0.160</code></pre>
<p>… and their 95% confidence intervals:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cidp12</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">CI.dp</span><span class="op">(</span><span class="va">grp2</span>, <span class="va">grp1</span>, <span class="fl">0.95</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">cidp13</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">CI.dp</span><span class="op">(</span><span class="va">grp3</span>, <span class="va">grp1</span>, <span class="fl">0.95</span> <span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">cidp23</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">CI.dp</span><span class="op">(</span><span class="va">grp3</span>, <span class="va">grp2</span>, <span class="fl">0.95</span> <span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cidp12</span>,<span class="va">cidp13</span>,<span class="va">cidp23</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.009 0.257 0.165 0.414 0.036 0.284</code></pre>
<p>Let’s put these numbers on the plot for easier examination using the graphic directives <code><a href="../reference/showSignificance.html">showSignificance()</a></code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, BSFactors  <span class="op">=</span> <span class="st">"Dose"</span>, variables <span class="op">=</span> <span class="st">"score"</span>, 
        statistic <span class="op">=</span> <span class="st">"d1"</span>,  errorbar  <span class="op">=</span> <span class="st">"CI"</span>, gamma     <span class="op">=</span> <span class="fl">0.95</span>, 
        plotStyle <span class="op">=</span> <span class="st">"line"</span>,
        adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="op">+</span><span class="fl">0.45</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title   <span class="op">=</span> <span class="st">"d_1 with difference-adjusted 95% confidence intervals of d_1"</span>,
     caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Note: Cohen's d_p and its confidence interval computed with the \n"</span>,
                     <span class="st">"true formula (Cousineau &amp; Goulet-Pelletier, 2020)"</span><span class="op">)</span>,      
     y       <span class="op">=</span> <span class="st">"d_1 relative to grand mean"</span><span class="op">)</span> <span class="op">+</span>  
<span class="fu"><a href="../reference/showSignificance.html">showSignificance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.01</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"dp = "</span>,<span class="va">dp12</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp12</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp12</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">", p &lt; .05"</span>,<span class="st">", p &gt; .05"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> 
<span class="fu"><a href="../reference/showSignificance.html">showSignificance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, <span class="fl">0.4</span>, <span class="op">-</span><span class="fl">0.01</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"dp = "</span>,<span class="va">dp13</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp13</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp13</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">", p &lt; .05"</span>,<span class="st">", p &gt; .05"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
<span class="fu"><a href="../reference/showSignificance.html">showSignificance</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, <span class="op">-</span><span class="fl">0.25</span>, <span class="op">+</span><span class="fl">0.01</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"dp = "</span>,<span class="va">dp23</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp23</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">cidp23</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,<span class="st">", p &lt; .05"</span>,<span class="st">", p &gt; .05"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<div class="figure">
<img src="Vignette9_files/figure-html/unnamed-chunk-11-1.png" alt="**Figure 2**. d_1 scores along with 95% confidence interval." width="384"><p class="caption">
<strong>Figure 2</strong>. d_1 scores along with 95% confidence interval.
</p>
</div>
<p>In the above, we used the fact that if both limits of the confidence interval are of the same sign, then they are on the same side with respect to zero, and therefore, excludes zero at a significance level of at least 5% (for 95% confidence intervals).</p>
<p>Let’s examine how good the difference-adjusted CI of <span class="math inline">\(d_1\)</span> are compared to the CI of <span class="math inline">\(d_p\)</span>. The following function (a) get the length of the Cohen’s <span class="math inline">\(d_p\)</span> interval; (b) average (in the square sense, see <a href="https://dcousin3.github.io/superb/articles/Vignette7.html">here</a>) the two difference-adjusted confidence intervals of <span class="math inline">\(d_1\)</span>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">compareCIlength</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span> <span class="op">{</span>
    <span class="co"># compute the Cohen's dp confidence interval length</span>
    <span class="va">cilength.dp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu">CI.dp</span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fu">CI.dp</span><span class="op">(</span><span class="va">g1</span>, <span class="va">g2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>

    <span class="co"># compute two d1 CI length, difference-adjusted</span>
    <span class="va">len1</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu">CI.d1</span><span class="op">(</span><span class="va">grp1</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu">CI.d1</span><span class="op">(</span><span class="va">grp1</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="va">len2</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu">CI.d1</span><span class="op">(</span><span class="va">grp2</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fu">CI.d1</span><span class="op">(</span><span class="va">grp2</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
    <span class="co"># average in the square sense the two d1 CI lengths</span>
    <span class="va">cilength.d1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="va">len1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">len2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>

    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span> dp.length <span class="op">=</span> <span class="va">cilength.dp</span>, d1.average.length <span class="op">=</span> <span class="va">cilength.d1</span><span class="op">)</span>
<span class="op">}</span>

<span class="fu">compareCIlength</span><span class="op">(</span><span class="va">grp1</span>,<span class="va">grp2</span><span class="op">)</span></code></pre></div>
<pre><code>##   dp.length d1.average.length
## 1     0.248             0.249</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">compareCIlength</span><span class="op">(</span><span class="va">grp1</span>,<span class="va">grp3</span><span class="op">)</span></code></pre></div>
<pre><code>##   dp.length d1.average.length
## 1     0.249             0.249</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">compareCIlength</span><span class="op">(</span><span class="va">grp2</span>,<span class="va">grp3</span><span class="op">)</span></code></pre></div>
<pre><code>##   dp.length d1.average.length
## 1     0.248             0.249</code></pre>
<p>As seen, there is no difference until the third decimal. The small difference comes from the fact that the degrees of freedom are separated, not pooled.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-cg20" class="csl-entry">
Cousineau, D., &amp; Goulet-Pelletier, J.-C. (2020). <em>A review of five techniques to derive confidence intervals with a special attention to the <span>C</span>ohen’s dp in the between-group design</em>. PsyArXiv. <a href="https://doi.org/10.31234/osf.io/s2597">https://doi.org/10.31234/osf.io/s2597</a>
</div>
<div id="ref-gc18" class="csl-entry">
Goulet-Pelletier, J.-C., &amp; Cousineau, D. (2018). A review of effect sizes and their confidence intervals, <span>P</span>art <span>I</span>: The <span>C</span>ohen’s d family. <em>The Quantitative Methods for Psychology</em>, <em>14</em>(4), 242–265. <a href="https://doi.org/10.20982/tqmp.14.4.p242">https://doi.org/10.20982/tqmp.14.4.p242</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
