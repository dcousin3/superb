<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting proportions with ``superb`` • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting proportions with ``superb``">
<meta property="og:description" content="This vignette shows how to plot proportions using superb.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteH.html">Plotting radar plots for illustrating profiles</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting proportions with
<code>superb</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/vignettes/VignetteC.Rmd" class="external-link"><code>vignettes/VignetteC.Rmd</code></a></small>
      <div class="hidden name"><code>VignetteC.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we show how to plot proportions. Proportions is one
way to summarize observations that are composed of succes and failure.
Success can be a positive reaction to a drug, an accurate completion of
a task, a survival after a dangerous ilness, etc. Failure are the
opposite of success.</p>
<p>A proportion is the number of success onto the total number of
trials. Similarly, if the success are coded with “1”s and failure, with
“0”s, then the proportion can be obtained indirectly by computing the
mean.</p>
<div class="section level3">
<h3 id="an-example">An example<a class="anchor" aria-label="anchor" href="#an-example"></a>
</h3>
<p>Consider an example where three groups of participants where
examined. The raw data may look like:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>Group</th>
<th>Score</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>subject 1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>subject 2</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>subject n1</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>subject n1+1</td>
<td>2</td>
<td>0</td>
</tr>
<tr class="even">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="odd">
<td>subject n1+n2</td>
<td>2</td>
<td>1</td>
</tr>
<tr class="even">
<td>subject n1+n2+1</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="odd">
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
<tr class="even">
<td>subject n1+n2+n3</td>
<td>3</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>in which there is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>1</mn></msub><annotation encoding="application/x-tex">n_1</annotation></semantics></math>
participant in Group 1,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>2</mn></msub><annotation encoding="application/x-tex">n_2</annotation></semantics></math>
in Group 2, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mn>3</mn></msub><annotation encoding="application/x-tex">n_3</annotation></semantics></math>
in Group 3. The data can be compiled by reporting the number of success
(let’s call them
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>s</mi><annotation encoding="application/x-tex">s</annotation></semantics></math>)
and the number of participants.</p>
<p>One example of results could be</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th>s</th>
<th>n</th>
<th>proportion</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Group 1</td>
<td>10</td>
<td>30</td>
<td>33.3%</td>
</tr>
<tr class="even">
<td>Group 2</td>
<td>18</td>
<td>28</td>
<td>64.3%</td>
</tr>
<tr class="odd">
<td>Group 3</td>
<td>10</td>
<td>26</td>
<td>38.5%</td>
</tr>
</tbody>
</table>
<p>Although making a plot of these proportions is easy, how can you plot
error bars around these proportions?</p>
</div>
<div class="section level3">
<h3 id="the-arcsine-transformation">The arcsine transformation<a class="anchor" aria-label="anchor" href="#the-arcsine-transformation"></a>
</h3>
<p>First proposed by Fisher, trigonometric transformation is one way to
represent proportions (Fisher proposed <code>cosine</code> transform,
but later Zubin proposed the <code>arcsine</code> transform). This
transformation stretches the extremities of the domain (near 0% and near
100%) so that the sampling variability is constant for any observed
proportion. Also, this transformation make the sampling distribution
nearly normal so that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
test can be used.</p>
<p>An improvement over the Fisher transformation was proposed by
Anscombe (1948). It is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>s</mi><mo>,</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mo>sin</mo><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><msqrt><mfrac><mrow><mi>s</mi><mo>+</mo><mn>3</mn><mi>/</mi><mn>8</mn></mrow><mrow><mi>n</mi><mo>+</mo><mn>3</mn><mi>/</mi><mn>4</mn></mrow></mfrac></msqrt><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
A(s, n) = \sin^{-1}\left( \sqrt{\frac{s + 3/8}{n + 3/4}} \right)
</annotation></semantics></math></p>
<p>The variance of such transformation is also theoretically given
by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><msub><mi>r</mi><mi>A</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mn>4</mn><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>+</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">
Var_A = \frac{1}{4(n+1/2)}
</annotation></semantics></math></p>
<p>As such, we have all the ingredients needed to make confidence
intervals!</p>
</div>
<div class="section level3">
<h3 id="defining-the-data">Defining the data<a class="anchor" aria-label="anchor" href="#defining-the-data"></a>
</h3>
<p>In what follows, we assume that the data are available in compiled
form, as in the second table above. Because <code><a href="../reference/superb.html">superb()</a></code> only
takes raw data, we will have to convert these into a long sequence of
zeros and ones.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># enter the compiled data into a data frame:</span></span>
<span><span class="va">compileddata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span>
<span>    s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">18</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">28</span>, <span class="fl">26</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The following converts the compiled data into a long data frame
containing ones and zeros so that <code><a href="../reference/superb.html">superb()</a></code> can be fed raw
data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">compileddata</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">group</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">group</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">i</span>, <span class="va">compileddata</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">)</span> <span class="op">)</span></span>
<span>        <span class="va">scores</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">scores</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">compileddata</span><span class="op">$</span><span class="va">s</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">compileddata</span><span class="op">$</span><span class="va">n</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">compileddata</span><span class="op">$</span><span class="va">s</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="va">dta</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">group</span>, scores <span class="op">=</span> <span class="va">scores</span> <span class="op">)</span> <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="defining-the-transformation-in-r">Defining the transformation in R<a class="anchor" aria-label="anchor" href="#defining-the-transformation-in-r"></a>
</h3>
<p>In the following, we define the A (Anscombe) transformation, the
standard error of the transformed scores, and the confidence
intervals:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the Anscombe transformation for a vector of binary data 0|1</span></span>
<span><span class="va">A</span> <span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span> <span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="fl">3</span><span class="op">/</span><span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">3</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span> <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span>   </span>
<span><span class="va">SE.A</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fl">0.5</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">CI.A</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span>, <span class="va">gamma</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu">SE.A</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">qchisq</a></span><span class="op">(</span><span class="va">gamma</span>, df<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is all we need to make a basic plot with
<code><a href="../reference/superb.html">superb()</a></code></p>
<p>… but we need a few libraries, so let’s load them here:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dcousin3/superb/" class="external-link">superb</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span>     <span class="co"># for asn_trans() non-linear scale</span></span></code></pre></div>
<p>Here we go:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ornate to decorate the plot a little bit...</span></span>
<span><span class="va">ornate</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Group"</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group A"</span>, <span class="st">"Group B"</span>, <span class="st">"Group C"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>    <span class="va">dta</span>, </span>
<span>    statistic <span class="op">=</span> <span class="st">"A"</span>, </span>
<span>    error     <span class="op">=</span> <span class="st">"CI"</span>,</span>
<span>    adjustment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,</span>
<span>    plotLayout <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="co"># just for the pleasure!</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="va">ornate</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Anscombe-transformed scores"</span> <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="VignetteC_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" alt="**Figure 1**. Anscombe-transformed scores as a function of group." width="288"><p class="caption">
<strong>Figure 1</strong>. Anscombe-transformed scores as a function of
group.
</p>
</div>
</div>
<div class="section level3">
<h3 id="reversing-the-transformation-to-see-proportions-">Reversing the transformation to see proportions.<a class="anchor" aria-label="anchor" href="#reversing-the-transformation-to-see-proportions-"></a>
</h3>
<p>The above plot shows Anscombe-transform scores. This may not be very
intuitive. It is then possible to undo the transformation so as to plot
proportions instead. The complicated part is to undo the confidence
limits.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the proportion of success for a vector of binary data 0|1</span></span>
<span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="va">x</span><span class="op">/</span><span class="va">n</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># the de-transformed confidence intervals from Anscombe-transformed scores</span></span>
<span><span class="va">CI.prop</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">v</span>, <span class="va">gamma</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span>     <span class="op">&lt;-</span> <span class="fu">A</span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="va">n</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span></span>
<span>    <span class="va">cilen</span> <span class="op">&lt;-</span> <span class="fu">CI.A</span><span class="op">(</span><span class="va">v</span>, <span class="va">gamma</span><span class="op">)</span></span>
<span>    <span class="va">ylo</span>   <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">-</span> <span class="va">cilen</span></span>
<span>    <span class="va">yhi</span>   <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">+</span> <span class="va">cilen</span></span>
<span>    <span class="co"># reverse arc-sin transformation: naive approach</span></span>
<span>    <span class="va">cilenlo</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">ylo</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span></span>
<span>    <span class="va">cilenhi</span> <span class="op">&lt;-</span> <span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">yhi</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cilenlo</span>, <span class="va">cilenhi</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Nothing more is needed. We can make the plot with these new
functions:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">scores</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>    <span class="va">dta</span>, </span>
<span>    statistic <span class="op">=</span> <span class="st">"prop"</span>, </span>
<span>    error     <span class="op">=</span> <span class="st">"CI"</span>,</span>
<span>    adjustment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,</span>
<span>    plotLayout <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> <span class="va">ornate</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Proportions"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>trans<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/transform_asn.html" class="external-link">asn_trans</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="VignetteC_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="**Figure 2**. Proportion as a function of group." width="288"><p class="caption">
<strong>Figure 2</strong>. Proportion as a function of group.
</p>
</div>
<p>This new plot is actually identical to the previous one as we plotted
the proportions using a non-linear scale (the <code><a href="https://scales.r-lib.org/reference/transform_asn.html" class="external-link">asn_trans()</a></code>
scale for arcsine). However, the vertical axis is now showing
graduations between 0% and 100% as is expected of proportions.</p>
</div>
<div class="section level3">
<h3 id="returning-to-the-example">Returning to the example<a class="anchor" aria-label="anchor" href="#returning-to-the-example"></a>
</h3>
<p>What can we conclude from the plot? You noted that we plotted
difference-adjusted confidence intervals. Hence, if at least one result
is not included in the confidence interval of another result, then the
chances are good that they differ significantly.</p>
<p>Running an analysis of proportions, it indicates the presence of a
main effect of Group
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mi>∞</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>3.06</mn><mo>,</mo><mi>p</mi><mo>=</mo><mn>.047</mn></mrow><annotation encoding="application/x-tex">F(2,\infty)= 3.06, p = .047</annotation></semantics></math>).
How to perform an analysis of proportions (ANOPA) is explained in <span class="citation">Laurencelle &amp; Cousineau (2023)</span>. Analysis of
proportion is now implemented in R with the package
<code>ANOPA</code>.</p>
<p>We see from the plot that the length of the error bars are about all
the same, suggesting homogeneous variance (because all the sample are of
comparable size). This is always the case as Anscombe transform is a
‘variance-stabilizing’ transformation in the sense that it makes all the
variances identical.</p>
</div>
<div class="section level3">
<h3 id="in-summary">In summary<a class="anchor" aria-label="anchor" href="#in-summary"></a>
</h3>
<p>The <code>superb</code> framework can be used to display any summary
statistics. Here, we showed how <code><a href="../reference/superb.html">superb()</a></code> can be used with
proportions. For within-subject designs involving proportions, it is
also possible to use the correlation adjustments <span class="citation">(as demonstrated in Laurencelle &amp; Cousineau,
2023)</span>.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-lc22" class="csl-entry">
Laurencelle, L., &amp; Cousineau, D. (2023). Analysis of proportions
using arcsine transform with any experimental design. <em>Frontiers in
Psychology</em>, <em>13</em>, 1045436. <a href="https://doi.org/10.3389/fpsyg.2022.1045436" class="external-link">https://doi.org/10.3389/fpsyg.2022.1045436</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
