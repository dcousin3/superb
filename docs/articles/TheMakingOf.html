<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The making-of the figures in the article • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The making-of the figures in the article">
<meta property="og:description" content="This vignette provides all the steps needed to make the figures from the article.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.22</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteH.html">Plotting radar plots for illustrating profiles</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The making-of the figures in the article</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/../vignettes/TheMakingOf.Rmd" class="external-link"><code>../vignettes/TheMakingOf.Rmd</code></a></small>
      <div class="hidden name"><code>TheMakingOf.Rmd</code></div>

    </div>

    
    
<p>Herein we provide the full code to realize Figures 1 to 4 that
illustrate the article describing the <code>superb</code> framework
<span class="citation">(Cousineau, Goulet, &amp; Harding, 2021)</span>.
These figures are based on ficticious data sets that are provided with
the package superb (<code>dataFigure1</code> to
<code>dataFigure4</code>).</p>
<p>Before we begin, we need to load a few packages, including
<code>superb</code> of course:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load relevant packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dcousin3.github.io/superb/" class="external-link">superb</a></span><span class="op">)</span>             <span class="co"># for superbPlot</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>            <span class="co"># for all the graphic directives</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span>          <span class="co"># for grid.arrange</span></span></code></pre></div>
<p>If they are not present on your computer, first upload them to your
computer with <code>install.packages("name of the package")</code>.</p>
<div class="section level2">
<h2 id="making-figure-1">Making Figure 1<a class="anchor" aria-label="anchor" href="#making-figure-1"></a>
</h2>
<p>The purpose of Figure 1 is to illustrate the difference in error bars
when the purpose of these measures of precision is to perform pair-wise
comparisons. It is based on the data from <code>dataFigure1</code>,
whose columns are</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataFigure1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id grp score</span></span>
<span><span class="co">## 1  1   1   117</span></span>
<span><span class="co">## 2  2   1   103</span></span>
<span><span class="co">## 3  3   1   113</span></span>
<span><span class="co">## 4  4   1   101</span></span>
<span><span class="co">## 5  5   1   104</span></span>
<span><span class="co">## 6  6   1   114</span></span></code></pre>
<p>where <code>id</code> is just a participant identifier,
<code>grp</code> indicate group membership (here only group 1 and group
2), and finally, <code>score</code> is the dependent variable.</p>
<p>The first panel on the left is based on stand-alone confidence
intervals and is obtained with :</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span> <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>            <span class="va">dataFigure1</span>, </span>
<span>            plotStyle   <span class="op">=</span> <span class="st">"line"</span> <span class="op">)</span> </span>
<span><span class="va">plt1a</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-3-1.png" alt="**Figure 1a**. Left panel of Figure 1." width="288"><p class="caption">
<strong>Figure 1a</strong>. Left panel of Figure 1.
</p>
</div>
<p>Note that these <em>stand-alone</em> error bars could have been
obtained by adding the argument
<code>adjustments = list(purpose = "single")</code> but as it is the
default value, it can be omitted.</p>
<p>The default <code>theme</code> to <code>ggplot</code>s is not very
attractive. Let’s decorate the plot a bit! To that end, I collected some
additional ggplot directives in a list:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornateBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Attitude towards class activities"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Collaborative\ngames"</span>, <span class="st">"Unstructured\nactivities"</span><span class="op">)</span><span class="op">)</span>, <span class="co">#new!</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">70</span>,<span class="fl">130</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span>, colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>so that the first plot, with these ornaments and a title, is:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1a</span> <span class="op">&lt;-</span> <span class="va">plt1a</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"(stand-alone)\n95% CI"</span><span class="op">)</span></span>
<span><span class="va">plt1a</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-5-1.png" alt="**Figure 1b**. Decorating left panel of Figure 1." width="288"><p class="caption">
<strong>Figure 1b</strong>. Decorating left panel of Figure 1.
</p>
</div>
<p>The second plot is obtained in a simar fashion with just one
additional argument requesting difference-adjusted confidence
intervals:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span> <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>            <span class="va">dataFigure1</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>, <span class="co">#new!</span></span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"line"</span> <span class="op">)</span></span>
<span><span class="va">plt1b</span> <span class="op">&lt;-</span> <span class="va">plt1b</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Difference-adjusted\n95% CI"</span><span class="op">)</span> </span>
<span><span class="va">plt1b</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-6-1.png" alt="**Figure 1c**. Making and decorating central panel of Figure 1." width="288"><p class="caption">
<strong>Figure 1c</strong>. Making and decorating central panel of
Figure 1.
</p>
</div>
<p>Finally, the <em>raincloud</em> plot is obtained by changing the
<code>plotStyle</code> argument:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>            <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>            <span class="va">dataFigure1</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,</span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"raincloud"</span>,                         <span class="co"># new layout!</span></span>
<span>            violinParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"green"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">)</span> <span class="co"># changed color to the violin</span></span>
<span><span class="va">plt1c</span> <span class="op">&lt;-</span> <span class="va">plt1c</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Difference-adjusted\n95% CI"</span><span class="op">)</span> </span>
<span><span class="va">plt1c</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-7-1.png" alt="**Figure 1d**. Making and decorating right panel of Figure 1." width="288"><p class="caption">
<strong>Figure 1d</strong>. Making and decorating right panel of Figure
1.
</p>
</div>
<p>All three plots are shown side-by-side with:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt1a</span>, <span class="va">plt1b</span>, <span class="va">plt1c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-8-1.png" alt="**Figure 1**. The complete Figure 1." width="864"><p class="caption">
<strong>Figure 1</strong>. The complete Figure 1.
</p>
</div>
<p>and exported to a file, with, e.g.:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Figure1.png"</span>, width <span class="op">=</span> <span class="fl">640</span>, height <span class="op">=</span> <span class="fl">320</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt1a</span>, <span class="va">plt1b</span>, <span class="va">plt1c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can change the smooth density estimator (the <code>kernel</code>
function) by adding to the <code>violinParams</code> list the following
attribute: <code>kernel = "rectangular"</code> for example to have a
ragged density estimator.</p>
<p>In the end, which error bars are correct? Remember that the
<em>golden rule of adjusted confidence intervals</em> is to look for
<strong>inclusion</strong>: for example, is the mean of the second group
part of the possible results suggested by the first group’s confidence
interval? yes it is in the central plot. The central plot therefore
indicate an absence of signficant difference. The confidence intervals
being 95%, this conclusion is statistically significant at the 5%
level.</p>
<p>Still not convinced? Let’s do a <em>t</em> test (actually, a Welch
test; add <code>var.equal = TRUE</code> for the regular <em>t</em> test;
<span class="citation">Delacre, Lakens, &amp; Leys (2017)</span>):</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>       <span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>       <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Welch Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dataFigure1$score[dataFigure1$grp == 1] and dataFigure1$score[dataFigure1$grp == 2]</span></span>
<span><span class="co">## t = 1.7612, df = 47.996, p-value = 0.08458</span></span>
<span><span class="co">## alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.7082323 10.7082323</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x mean of y </span></span>
<span><span class="co">##       105       100</span></span></code></pre>
<p>There are no significant difference in these data at the .05 level,
so that the error bar of a 95% confidence interval should contain the
other result, as is the case in the central panel.</p>
<p>Finally, you could try here the Tryon’s adjustments (changing to
<code>adjustments = list(purpose = "tryon")</code>). However, you will
notice no difference at all. Indeed, the variances are almost identical
in the two groups (9.99 vs.  10.08).</p>
</div>
<div class="section level2">
<h2 id="making-figure-2">Making Figure 2<a class="anchor" aria-label="anchor" href="#making-figure-2"></a>
</h2>
<p>Figure 2 is made in a similar fashion, and using the same decorations
<code>ornate</code> as above with just a different name for the variable
on the horizontal axis:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornateWS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Moment"</span><span class="op">)</span>,                                                <span class="co">#different!</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pre\ntreatment"</span>, <span class="st">"Post\ntreatment"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Statistics understanding"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">75</span>,<span class="fl">125</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span>, colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The difference in the present example is that the data are from a
within-subject design with two repeated measures. The dataset must be in
a wide format, e.g.,</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dataFigure2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   id pre post</span></span>
<span><span class="co">## 1  1 105  128</span></span>
<span><span class="co">## 2  2  96   96</span></span>
<span><span class="co">## 3  3  88  102</span></span>
<span><span class="co">## 4  4  80   88</span></span>
<span><span class="co">## 5  5  90   83</span></span>
<span><span class="co">## 6  6  86   99</span></span></code></pre>
<p>This makes the left panel:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pre</span>,<span class="va">post</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> ,</span>
<span>            <span class="va">dataFigure2</span>, </span>
<span>            WSFactors    <span class="op">=</span> <span class="st">"Moment(2)"</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span>,</span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"line"</span> <span class="op">)</span> </span>
<span><span class="va">plt2a</span> <span class="op">&lt;-</span> <span class="va">plt2a</span> <span class="op">+</span> <span class="va">ornateWS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Stand-alone\n95% CI"</span><span class="op">)</span></span>
<span><span class="va">plt2a</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-13-1.png" alt="**Figure 2a**. Making left panel of Figure 2." width="288"><p class="caption">
<strong>Figure 2a</strong>. Making left panel of Figure 2.
</p>
</div>
<p>… and this makes the central panel, specifying the <code>CA</code>
(<em>correlation-adjusted</em>) decorelation technique:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pre</span>, <span class="va">post</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span> ,</span>
<span>            <span class="va">dataFigure2</span>, </span>
<span>            WSFactors    <span class="op">=</span> <span class="st">"Moment(2)"</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span>, <span class="co">#new</span></span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"line"</span> <span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## superb::DEPRECATED: The argument `plotStyle` is deprecated; use the argument `plotLayout`. Continuing...</span></span></code></pre>
<pre><code><span><span class="co">## superb::FYI: The average correlation per group is  0.8366</span></span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2b</span> <span class="op">&lt;-</span> <span class="va">plt2b</span> <span class="op">+</span> <span class="va">ornateWS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Correlation and difference-\nadjusted 95% CI"</span><span class="op">)</span> </span>
<span><span class="va">plt2b</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-14-1.png" alt="**Figure 2b**. Making central panel of Figure 2." width="288"><p class="caption">
<strong>Figure 2b</strong>. Making central panel of Figure 2.
</p>
</div>
<p>As seen, <code>superbPlot</code> issues relevant information
(indicated with <code>FYI</code> messages), here the correlation.</p>
<p>To get a sense of the general trends in the data, we can examine the
data participants per participants, joining their results with a line.
As seen below, for most participants, the trend is upward, suggesting a
strongly reliable effect of the moment:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pre</span>, <span class="va">post</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>            <span class="va">dataFigure2</span>, </span>
<span>            WSFactors    <span class="op">=</span> <span class="st">"Moment(2)"</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span>,</span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"pointindividualline"</span> <span class="op">)</span>   <span class="co">#new</span></span>
<span><span class="va">plt2c</span> <span class="op">&lt;-</span> <span class="va">plt2c</span> <span class="op">+</span> <span class="va">ornateWS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Correlation and difference-\nadjusted 95% CI"</span><span class="op">)</span></span>
<span><span class="va">plt2c</span> </span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-15-1.png" alt="**Figure 2c**. Making third panel of Figure 2." width="288"><p class="caption">
<strong>Figure 2c</strong>. Making third panel of Figure 2.
</p>
</div>
<p>Just for the exercice, we also compute the plot of the difference
between the scores. To that end, we need different labels on the x-axis
and a different range:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornateWS2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Difference"</span><span class="op">)</span>,                                      </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Post minus Pre\ntreatment"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Statistics understanding"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">25</span>,<span class="op">+</span><span class="fl">25</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We then compute the differences and make the plot:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dataFigure2</span><span class="op">$</span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="va">dataFigure2</span><span class="op">$</span><span class="va">post</span> <span class="op">-</span> <span class="va">dataFigure2</span><span class="op">$</span><span class="va">pre</span></span>
<span><span class="va">plt2d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>            <span class="va">diff</span> <span class="op">~</span> <span class="va">.</span>,</span>
<span>            <span class="va">dataFigure2</span>, </span>
<span>            WSFactor     <span class="op">=</span> <span class="st">"Moment(1)"</span>, </span>
<span>            adjustments  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, decorrelation <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>,</span>
<span>            plotStyle    <span class="op">=</span> <span class="st">"raincloud"</span>,</span>
<span>            violinParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span> <span class="op">)</span>  <span class="co">#new</span></span>
<span><span class="va">plt2d</span> <span class="op">&lt;-</span> <span class="va">plt2d</span> <span class="op">+</span> <span class="va">ornateWS2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"95% CI \nof the difference"</span><span class="op">)</span></span>
<span><span class="va">plt2d</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-17-1.png" alt="**Figure 2d**. Making right panel of Figure 2." width="288"><p class="caption">
<strong>Figure 2d</strong>. Making right panel of Figure 2.
</p>
</div>
<p>This last plot does not require decorrelation and is not adjusted for
difference. Decorrelation would not do anything as <code>diff</code> is
a single column; difference-adjustment is inadequate here as the
difference is to be compared to a fix value (namely 0, for zero
improvement)</p>
<p>Assembling all four panels, we get:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt2a</span>, <span class="va">plt2b</span>, <span class="va">plt2c</span>, <span class="va">plt2d</span>,  ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-18-1.png" alt="**Figure 2**. The complete Figure 2." width="864"><p class="caption">
<strong>Figure 2</strong>. The complete Figure 2.
</p>
</div>
<p>… which can be exported to a file as usual:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Figure2.png"</span>, width <span class="op">=</span> <span class="fl">850</span>, height <span class="op">=</span> <span class="fl">320</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt2a</span>, <span class="va">plt2b</span>, <span class="va">plt2c</span>, <span class="va">plt2d</span>,  ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Which error bars are depicting the significance of the result most
aptly? The adjusted ones seen in the central panel, as confirmed by a
t-test on paired data:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure2</span><span class="op">$</span><span class="va">pre</span>, <span class="va">dataFigure2</span><span class="op">$</span><span class="va">post</span>, paired<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Paired t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dataFigure2$pre and dataFigure2$post</span></span>
<span><span class="co">## t = -2.9046, df = 24, p-value = 0.007776</span></span>
<span><span class="co">## alternative hypothesis: true mean difference is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -8.552864 -1.447136</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean difference </span></span>
<span><span class="co">##              -5</span></span></code></pre>
<p>The confidence interval of one moment does not <em>include</em> the
result from the other moment, indicating a significant difference
between the two moments.</p>
</div>
<div class="section level2">
<h2 id="making-figure-3">Making Figure 3<a class="anchor" aria-label="anchor" href="#making-figure-3"></a>
</h2>
<p>The novel element in Figure 3 is the fact that the participants have
been recruited by clusters of participants.</p>
<p>We first adapt the ornaments for this example:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornateCRS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Quality of policies"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"From various\nfields"</span>, <span class="st">"From the\nsame field"</span><span class="op">)</span><span class="op">)</span>, <span class="co">#new!</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">75</span>,<span class="fl">125</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span>, colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then, we get an unadjusted plot as usual:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt3a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">VD</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>    <span class="va">dataFigure3</span>, </span>
<span>    adjustments   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, samplingDesign <span class="op">=</span> <span class="st">"SRS"</span><span class="op">)</span>,</span>
<span>    plotStyle     <span class="op">=</span> <span class="st">"line"</span> <span class="op">)</span></span>
<span><span class="va">plt3a</span> <span class="op">&lt;-</span> <span class="va">plt3a</span> <span class="op">+</span> <span class="va">ornateCRS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Stand-alone\n95% CI"</span><span class="op">)</span> </span>
<span><span class="va">plt3a</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-22-1.png" alt="**Figure 3a**. The left panel of Figure 3." width="288"><p class="caption">
<strong>Figure 3a</strong>. The left panel of Figure 3.
</p>
</div>
<p>Here, the option <code>samplingDesign = "SRS"</code> is the default
and can be omitted.</p>
<p>To indicate the presence of <em>cluster-randomized sampling</em>, the
<code>samplingDesign</code> option is set to <code>"CRS"</code> and an
additional information, <code>clusterColumn</code> is indicated to
identify the column containing the cluster membership information:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">VD</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>    <span class="va">dataFigure3</span>, </span>
<span>    adjustments   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, samplingDesign <span class="op">=</span> <span class="st">"CRS"</span><span class="op">)</span>, <span class="co">#new</span></span>
<span>    plotStyle     <span class="op">=</span> <span class="st">"line"</span>, </span>
<span>    clusterColumn <span class="op">=</span> <span class="st">"cluster"</span> <span class="op">)</span>                                           <span class="co">#new</span></span></code></pre></div>
<pre><code><span><span class="co">## superb::DEPRECATED: The argument `plotStyle` is deprecated; use the argument `plotLayout`. Continuing...</span></span></code></pre>
<pre><code><span><span class="co">## superb::FYI: The ICC1 per group are  0.491 0.204</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt3b</span> <span class="op">&lt;-</span> <span class="va">plt3b</span> <span class="op">+</span> <span class="va">ornateCRS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Cluster and difference-\nadjusted 95% CI"</span><span class="op">)</span></span>
<span><span class="va">plt3b</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-23-1.png" alt="**Figure 3b**. The central panel of Figure 3." width="288"><p class="caption">
<strong>Figure 3b</strong>. The central panel of Figure 3.
</p>
</div>
<p>An inspection of the distribution does not make the cluster structure
evident and therefore a raincloud plot is maybe little informative in
the context of cluster randomized sampling…</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt3c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">VD</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>    <span class="va">dataFigure3</span>, </span>
<span>    adjustments   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, samplingDesign <span class="op">=</span> <span class="st">"CRS"</span><span class="op">)</span>,</span>
<span>    plotStyle     <span class="op">=</span> <span class="st">"raincloud"</span>, </span>
<span>    violinParams  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"green"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>    clusterColumn <span class="op">=</span> <span class="st">"cluster"</span> <span class="op">)</span></span>
<span><span class="va">plt3c</span> <span class="op">&lt;-</span> <span class="va">plt3c</span> <span class="op">+</span> <span class="va">ornateCRS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Cluster and difference-\nadjusted 95% CI"</span><span class="op">)</span></span></code></pre></div>
<p>Here is the complete Figure 3:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt3a</span>, <span class="va">plt3b</span>, <span class="va">plt3c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-25-1.png" alt="**Figure 3**. The complete Figure 3." width="768"><p class="caption">
<strong>Figure 3</strong>. The complete Figure 3.
</p>
</div>
<p>This figure is saved as before with</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Figure3.png"</span>, width <span class="op">=</span> <span class="fl">640</span>, height <span class="op">=</span> <span class="fl">320</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt3a</span>, <span class="va">plt3b</span>, <span class="va">plt3c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>To make the correct <em>t</em> test in the present case, we need a
correction factor called <span class="math inline">\(\lambda\)</span>.
An easy way is the following <span class="citation">(see Cousineau &amp;
Laurencelle, 2016 for more)</span></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span> <span class="va">dataFigure3</span><span class="op">$</span><span class="va">VD</span><span class="op">[</span><span class="va">dataFigure3</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                  <span class="va">dataFigure3</span><span class="op">$</span><span class="va">VD</span><span class="op">[</span><span class="va">dataFigure3</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>                <span class="op">)</span></span>
<span><span class="co"># mean ICCs per group, as given by superbPlot</span></span>
<span><span class="va">micc</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.491335</span>, <span class="fl">0.203857</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co"># lambda from five clusters of 5 participants each</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CousineauLaurencelleLambda.html">CousineauLaurencelleLambda</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">micc</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">tcorrected</span>  <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">statistic</span> <span class="op">/</span> <span class="va">lambda</span></span>
<span><span class="va">pcorrected</span>  <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="va">tcorrected</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"t-test corrected for cluster-randomized sampling: t("</span>,</span>
<span>    <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dataFigure3</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>,<span class="st">") = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tcorrected</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">", p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pcorrected</span>, <span class="fl">3</span><span class="op">)</span>,<span class="st">"\n"</span>, sep<span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## t-test corrected for cluster-randomized sampling: t(96) = 1.419, p = 0.114</span></span></code></pre>
<p>As seen, the proper test is returning a coherent decision with the
proper error bars.</p>
</div>
<div class="section level2">
<h2 id="making-figure-4">Making Figure 4<a class="anchor" aria-label="anchor" href="#making-figure-4"></a>
</h2>
<p>Figure 4 is an illustration of the impact of sampling among a finite
population.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornateBS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Metabolic score"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Response to treatment"</span><span class="op">)</span><span class="op">)</span>, <span class="co">#new!</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">75</span>,<span class="fl">125</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">100</span>, colour <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span>, linetype<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_light</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span> plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Lets do Figure 4 (see below for each plot in a single figure).</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt4a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>    <span class="va">dataFigure4</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, popSize <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> </span>
<span><span class="va">plt4a</span> <span class="op">&lt;-</span> <span class="va">plt4a</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Stand-alone\n95% CI"</span><span class="op">)</span> </span></code></pre></div>
<p>The option <code>popSize = Inf</code> is the default; it indicates
that the population is presumed of infinite size. A finite size can be
given, as</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt4b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">group</span>, </span>
<span>    <span class="va">dataFigure4</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, popSize <span class="op">=</span> <span class="fl">50</span> <span class="op">)</span>, <span class="co"># new!</span></span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> </span>
<span><span class="va">plt4b</span> <span class="op">&lt;-</span> <span class="va">plt4b</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Population size-\nadjusted 95% CI"</span><span class="op">)</span> </span></code></pre></div>
<p>We illustrate the plot along some distribution information with a
violin plot:</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt4c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">group</span>,</span>
<span>    <span class="va">dataFigure4</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, popSize <span class="op">=</span> <span class="fl">50</span> <span class="op">)</span>, <span class="co"># new!</span></span>
<span>    plotStyle<span class="op">=</span><span class="st">"pointjitterviolin"</span>,</span>
<span>    violinParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"green"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>  <span class="op">)</span> </span>
<span><span class="va">plt4c</span> <span class="op">&lt;-</span> <span class="va">plt4c</span> <span class="op">+</span> <span class="va">ornateBS</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="st">"Population size-\nadjusted 95% CI"</span><span class="op">)</span> </span></code></pre></div>
<p>Which are reunited as usual:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt4a</span>, <span class="va">plt4b</span>, <span class="va">plt4c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="TheMakingOf_files/figure-html/unnamed-chunk-32-1.png" alt="**Figure 4**. The complete Figure 4." width="864"><p class="caption">
<strong>Figure 4</strong>. The complete Figure 4.
</p>
</div>
<p>…and saved with:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"Figure4.png"</span>, width <span class="op">=</span> <span class="fl">640</span>, height <span class="op">=</span> <span class="fl">320</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt4a</span>, <span class="va">plt4b</span>, <span class="va">plt4c</span>, ncol<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The corrected <em>t</em> test, performed by adjusting for the
proportion of the population examined <span class="citation">(see
Thompson, 2012)</span>, confirms the presence of a significant
difference:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure4</span><span class="op">$</span><span class="va">score</span>, mu<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">tcorrected</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">statistic</span> <span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dataFigure4</span><span class="op">)</span> <span class="op">/</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">pcorrected</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/TDist.html" class="external-link">pt</a></span><span class="op">(</span><span class="va">tcorrected</span>, <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"t-test corrected for finite-population size: t("</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dataFigure4</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span>,<span class="st">") = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">tcorrected</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="st">", p = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">pcorrected</span>, <span class="fl">3</span><span class="op">)</span>,<span class="st">"\n"</span>, sep<span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## t-test corrected for finite-population size: t(24) = 2.644, p = 0.007</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-cgh21" class="csl-entry">
Cousineau, D., Goulet, M.-A., &amp; Harding, B. (2021). Summary plots
with adjusted error bars: The superb framework with an implementation in
<span>R</span>. <em>Advances in Methods and Practices in Psychological
Science</em>, <em>4</em>, 1–18. <a href="https://doi.org/10.1177/25152459211035109" class="external-link">https://doi.org/10.1177/25152459211035109</a>
</div>
<div id="ref-cl16" class="csl-entry">
Cousineau, D., &amp; Laurencelle, L. (2016). A correction factor for the
impact of cluster randomized sampling and its applications.
<em>Psychological Methods</em>, <em>21</em>, 121–135. <a href="https://doi.org/10.1037/met0000055" class="external-link">https://doi.org/10.1037/met0000055</a>
</div>
<div id="ref-dll17" class="csl-entry">
Delacre, M., Lakens, D., &amp; Leys, C. (2017). Why psychologists should
by default use welch’s t-test instead of student’s t-test.
<em>International Review of Social Psychology</em>, <em>30</em>(1). <a href="https://doi.org/10.5334/irsp.82" class="external-link">https://doi.org/10.5334/irsp.82</a>
</div>
<div id="ref-t12" class="csl-entry">
Thompson, S. K. (2012). <em>Sampling</em>. New York: Wiley.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
