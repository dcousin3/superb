<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Why use difference-adjusted confidence intervals? • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Why use difference-adjusted confidence intervals?">
<meta property="og:description" content="This vignette explains the difference between a regular confidence interval and a difference-adjusted confidence interval.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteH.html">Plotting radar plots for illustrating profiles</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Why use difference-adjusted confidence
intervals?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/../vignettes/Vignette2.Rmd" class="external-link"><code>../vignettes/Vignette2.Rmd</code></a></small>
      <div class="hidden name"><code>Vignette2.Rmd</code></div>

    </div>

    
    
<p>Most studies examine the effect of a certain factor on a measure.
However, very rarely do we have hypotheses stating what would be the
expected result. Instead, we have a control group to which the results
of the treatment group will be compared <span class="citation">(Cousineau, 2017)</span>.</p>
<div class="section level3">
<h3 id="a-paradoxical-example">A paradoxical example<a class="anchor" aria-label="anchor" href="#a-paradoxical-example"></a>
</h3>
<p>Imagine a study in a school examining the impact of playing
collaborative games before beginning the classes. This study most likely
will have two groups, one where the students are playing collaborative
games and one where the students will have non- structured activities
prior to classes. The objective of the study is to <em>compare</em> the
two groups.</p>
<p>Consider the results obtained. The measurement instrument tends to
return scores near 100.</p>
<div class="figure">
<img src="Vignette2_files/figure-html/unnamed-chunk-2-1.png" alt="**Figure 1**. Mean scores along with 95% confidence interval for two groups of students on the quality of learning behavior." width="288"><p class="caption">
<strong>Figure 1</strong>. Mean scores along with 95% confidence
interval for two groups of students on the quality of learning behavior.
</p>
</div>
<p>As seen, there seems to be a better score for students playing
collaborative games. Taking into account the confidence interval, the
manipulation seems to improve significantly the learning behavior as the
lower end of the <em>Collaborative games</em> interval is above the
<em>Unstructured activity</em> mean (and vice versa).</p>
<p>What a surprise to discover that a <em>t</em> test will
<strong>NOT</strong> confirm this impression (t(48) = 1.76, p =
.085):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>        <span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>        var.equal<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Two Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dataFigure1$score[dataFigure1$grp == 1] and dataFigure1$score[dataFigure1$grp == 2]</span></span>
<span><span class="co">## t = 1.7612, df = 48, p-value = 0.08458</span></span>
<span><span class="co">## alternative hypothesis: true difference in means is not equal to 0</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  -0.7082201 10.7082201</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x mean of y </span></span>
<span><span class="co">##       105       100</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="the-origin-of-the-paradox">The origin of the paradox<a class="anchor" aria-label="anchor" href="#the-origin-of-the-paradox"></a>
</h3>
<p>The reason is that the confidence intervals used are “stand-alone”:
They can be used to examine, say, the first group to the value 100. As
this value is outside the interval, we are correct in concluding that
the first group’s mean is significantly different from 100 (with level
<span class="math inline">\(\alpha\)</span> of .05) from 100, as
confirmed by a single-group <em>t</em> test:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span>, mu<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dataFigure1$score[dataFigure1$grp == 1]</span></span>
<span><span class="co">## t = 2.5021, df = 24, p-value = 0.01956</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 100</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  100.8756 109.1244</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##       105</span></span></code></pre>
<p>Likewise, the second group’ mean is significantly different from 105
(which happens to be the first group’s mean):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">score</span><span class="op">[</span><span class="va">dataFigure1</span><span class="op">$</span><span class="va">grp</span><span class="op">==</span><span class="fl">2</span><span class="op">]</span>, mu<span class="op">=</span><span class="fl">105</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  One Sample t-test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dataFigure1$score[dataFigure1$grp == 2]</span></span>
<span><span class="co">## t = -2.4794, df = 24, p-value = 0.02057</span></span>
<span><span class="co">## alternative hypothesis: true mean is not equal to 105</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##   95.83795 104.16205</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## mean of x </span></span>
<span><span class="co">##       100</span></span></code></pre>
<p>This is precisely the purpose of <strong>stand-alone</strong>
confidence intervals: to compare a single result to a fix value. The fix
value (here 100 for the first group and 105 for the second group) has no
uncertainty, it is a constant.</p>
<p>In contrast, the two-group <em>t</em> test compares two means, the
two of which are uncertain. Therefore, in making a confidence interval,
it is necessary that the basic, stand-alone, confidence interval be
<em>informed</em> that it is going to be compared —not to a fix value—
to a second quantity which is itself uncertain.</p>
<p>Using the language of analyse of variances, we can say that when the
purpose of the plot is to compare means to other means, there is more
variances in the comparisons than there is in single groups in
isolation.</p>
</div>
<div class="section level3">
<h3 id="adjusting-the-error-bars">Adjusting the error bars<a class="anchor" aria-label="anchor" href="#adjusting-the-error-bars"></a>
</h3>
<p>Assuming that the variances are roughly homogeneous between group (an
assumption made by the <em>t</em> test, but see below), there is a
simple adjustment that can be brought to the error bars: just increase
their length by <span class="math inline">\(\sqrt{2}\)</span>. As <span class="math inline">\(\sqrt{2} \approx 1.41\)</span> it means increasing
their length by 41%.</p>
<p>With <code>superbPlot</code>, this so-called <em>difference
adjustment</em> <span class="citation">(Baguley, 2012)</span> is
obtained easily by adding an adjustment to the list of adjustments with
<code>adjustments = list(purpose =  "difference")</code>, as seen
below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>, </span>
<span>    <span class="va">dataFigure1</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,  <span class="co"># the only new thing here</span></span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Difference-adjusted\n95% confidence intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">115</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Collaborative\ngames"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Unstructured\nactivity"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Vignette2_files/figure-html/unnamed-chunk-6-1.png" alt="**Figure 2**. Mean scores along with difference-adjusted 95% confidence interval for two groups of students on the quality of learning behavior." width="288"><p class="caption">
<strong>Figure 2</strong>. Mean scores along with difference-adjusted
95% confidence interval for two groups of students on the quality of
learning behavior.
</p>
</div>
<p>This is where the usefulness of <code>superb</code> is apparent: it
only required an option to mutate the plot from a plot showing means
with stand-alone confidence intervals to a plot showing means with
difference-adjusted confidence intervals <span class="citation">(Cousineau, Goulet, &amp; Harding, 2021)</span>.</p>
</div>
<div class="section level3">
<h3 id="illustrating-the-impact-of-the-adjustments">Illustrating the impact of the adjustments<a class="anchor" aria-label="anchor" href="#illustrating-the-impact-of-the-adjustments"></a>
</h3>
<p>Just for comparison purposes, let’s show both plots side-by-side.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: package 'gridExtra' was built under R version 4.3.3</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>, </span>
<span>    <span class="va">dataFigure1</span>, </span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"(stand-alone)\n95% confidence intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">115</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Collaborative\ngames"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Unstructured\nactivity"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>, </span>
<span>    <span class="va">dataFigure1</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>, </span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Difference-adjusted\n95% confidence intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">115</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Collaborative\ngames"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Unstructured\nactivity"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">plt1</span>, <span class="va">plt2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Vignette2_files/figure-html/unnamed-chunk-7-1.png" alt="**Figure 3**. Two representation of the data with unadjusted (left) and adjusted (right) 95% confidence intervals" width="700"><p class="caption">
<strong>Figure 3</strong>. Two representation of the data with
unadjusted (left) and adjusted (right) 95% confidence intervals
</p>
</div>
<p>A second way to compare the two plots is to superimpose them, as in
Figure 4:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the two plots, nudging the error bars, using distinct colors, and </span></span>
<span><span class="co"># having the second plot's background transparent (with ``makeTransparent()`` )</span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>    <span class="va">dataFigure1</span>, </span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span>,position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"(red) Difference-adjusted 95% confidence intervals\n(blue) (stand-alone) 95% confidence intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">115</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Collaborative\ngames"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Unstructured\nactivity"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superb.html">superb</a></span><span class="op">(</span></span>
<span>    <span class="va">score</span> <span class="op">~</span> <span class="va">grp</span>,</span>
<span>    <span class="va">dataFigure1</span>, </span>
<span>    adjustments<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>, </span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span>,position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Score"</span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"(red) Difference-adjusted 95% confidence intervals\n(blue) (stand-alone) 95% confidence intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">85</span>,<span class="fl">115</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Collaborative\ngames"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Unstructured\nactivity"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># transform the ggplots into "grob" so that they can be manipulated</span></span>
<span><span class="va">plt1g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt1</span><span class="op">)</span></span>
<span><span class="va">plt2g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt2</span> <span class="op">+</span> <span class="fu"><a href="../reference/makeTransparent.html">makeTransparent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span>
<span></span>
<span><span class="co"># put the two grob onto an empty ggplot (as the positions are the same, they will be overlayed)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt1g</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt2g</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Vignette2_files/figure-html/unnamed-chunk-8-1.png" alt="**Figure 4**. Two representations of the results with adjusted and unadjusted error bars on the same plot" width="576"><p class="caption">
<strong>Figure 4</strong>. Two representations of the results with
adjusted and unadjusted error bars on the same plot
</p>
</div>
<p>As seen, the <code>difference-adjusted</code> error bars are wider.
This is to be expected: their purposes (comparing two means) introduces
more variability, and variability always reduces precision.</p>
</div>
<div class="section level3">
<h3 id="two-options">Two options<a class="anchor" aria-label="anchor" href="#two-options"></a>
</h3>
<p>There are two methods to adjust for the purpose of the error
bars:</p>
<ul>
<li><p><code>"difference"</code>: This method is the simplest. It
increases the error bars by a factor of <span class="math inline">\(\sqrt{2}\)</span> on the premise that the
variances are homogeneous</p></li>
<li><p><code>"tryon"</code>: This method, proposed in <span class="citation">Tryon (2001)</span>, is used when the variances are
inhomogeneous. It replaces the <span class="math inline">\(\sqrt{2}\)</span> correction factor by a factor
<span class="math inline">\(2 \times E\)</span> based on the
heterogeneity of the variances. In the case where the error bars are
roughly homogeneous, there is no visible difference with
<code>"difference"</code>. See[Vignette 7] (<a href="https://dcousin3.github.io/superb/articles/Vignette7.html" class="external-link uri">https://dcousin3.github.io/superb/articles/Vignette7.html</a>)
for more</p></li>
</ul>
<p>The option <code>"single"</code> is used if the purpose is obtain
“stand-alone” error bars or error bars that are to be compared to an
<em>a priori</em> determine value. Such error bars are inapt to perform
pair-wise comparisons.</p>
</div>
<div class="section level3">
<h3 id="in-conclusion">In conclusion<a class="anchor" aria-label="anchor" href="#in-conclusion"></a>
</h3>
<p>Adjusting the confidence intervals is important to have coherence
between the test and the figure. If you are to claim that there is no
difference but show Figure 1, an examinator (you know, a reviewer) may
raise a red flag and cast doubt on your conclusions (opening the door to
many rounds of reviews or rejection if this is a submitted work).</p>
<p>Having coherence between the figures and the tests reported in your
document is one way to improve the clarity of your work. Coherence here
comes cheap: You just need to add in the figure caption
“Difference-adjusted” before “95% confidence intervals”.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-b12" class="csl-entry">
Baguley, T. (2012). Calculating and graphing within-subject confidence
intervals for ANOVA. <em>Behavior Research Methods</em>, <em>44</em>,
158–175. <a href="https://doi.org/10.3758/s13428-011-0123-7" class="external-link">https://doi.org/10.3758/s13428-011-0123-7</a>
</div>
<div id="ref-c17" class="csl-entry">
Cousineau, D. (2017). Varieties of confidence intervals. <em>Advances in
Cognitive Psychology</em>, <em>13</em>, 140–155. <a href="https://doi.org/10.5709/acp-0214-z" class="external-link">https://doi.org/10.5709/acp-0214-z</a>
</div>
<div id="ref-cgh21" class="csl-entry">
Cousineau, D., Goulet, M.-A., &amp; Harding, B. (2021). Summary plots
with adjusted error bars: The superb framework with an implementation in
<span>R</span>. <em>Advances in Methods and Practices in Psychological
Science</em>, <em>4</em>, 1–18. <a href="https://doi.org/10.1177/25152459211035109" class="external-link">https://doi.org/10.1177/25152459211035109</a>
</div>
<div id="ref-t01" class="csl-entry">
Tryon, W. W. (2001). Evaluating statistical difference, equivalence, and
indeterminacy using inferential confidence intervals: An integrated
alternative method of conducting null hypothesis statistical tests.
<em>Psychological Methods</em>, <em>6</em>, 371–386. <a href="https://doi.org/10.1037/1082-989X.6.4.371" class="external-link">https://doi.org/10.1037/1082-989X.6.4.371</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
