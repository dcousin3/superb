<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Plotting frequencies using ``superb`` • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Plotting frequencies using ``superb``">
<meta property="og:description" content="This vignette shows how to plot frequencies along with confidence intervals.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.15</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Plotting frequencies using
<code>superb</code>
</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/../vignettes/VignetteF.Rmd" class="external-link"><code>../vignettes/VignetteF.Rmd</code></a></small>
      <div class="hidden name"><code>VignetteF.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="how-to-plot-frequencies-along-with-confidence-intervals-using-superb">How to plot frequencies along with confidence intervals using
<code>superb</code><a class="anchor" aria-label="anchor" href="#how-to-plot-frequencies-along-with-confidence-intervals-using-superb"></a>
</h3>
<p>Many studies collect data that are categorized according to one or
some factors. For example, it is possible to categorize a sample of
college students based on their gender and on their projects after
college is finished (go to university, get a job, etc.). Here, there are
two “factors”: gender and plans post studies. The measure for each
participant is in which of the “cells” the participant is categorized.
Typically, the data are summarized as <em>frequencies</em>, that is, the
<em>count</em> of participants in each of the various combinations of
the factor levels. For two classification factors, the data are said to
be two-way classfication data, or to form a contingency table. Nothing
prevent from having more than 2 factors, e.g., a three-way
classification data.</p>
<p>Although frequencies are often given in a table, these tables
provides very little insight with regards to trends. It is far more
adviseable to illustrate the frequencies using a plot showing the count
in each levels of the factors. However, to be truly informative, such a
plot should be accompanied with error bars such as the confidence
interval. Herein, we show how this can be done.</p>
<p>We adopted an approach based on the pivot method developed by <span class="citation">Clopper &amp; Pearson (1934)</span>. This method is
given in an analytic form in <span class="citation">Leemis &amp; Trivedi
(1996)</span>. Such confidence intervals are commonly non-symmetrical
around the estimate; they are also exact or conservative, in which case
the length of the interval tends to be too long when the frequencies are
small <span class="citation">(Chen, 1990)</span>.</p>
<p>Given the total sample size <span class="math inline">\(N\)</span> in
all the cells, each observed frequency <span class="math inline">\(n\)</span> in a given cell is used to get lower
and upper confidence bounds around the proportion <span class="math inline">\(\hat{p}=n/N\)</span> with the formula: <span class="math display">\[
    \hat{\pi}_{\,\text{low}}=\left(
        1+\frac{N-n+1}{n F_{1-\alpha/2}(2n,2(N-n+1)}
    \right)^{-1}
    &lt; \hat{\pi} &lt;
    \left(
        1+\frac{N-n}{(n+1) F_{\alpha/2}(2(n+1),2(N-x)}
    \right)^{-1}
    =\hat{\pi}_{\,\text{high}}
\]</span> in which <span class="math inline">\(F_{q}\)</span> denotes
the <span class="math inline">\(100\;q\)</span>% quantile of an <span class="math inline">\(F\)</span> distribution and <span class="math inline">\(1-\alpha\)</span> the desired coverage of the
interval, often 95%. The interval <span class="math display">\[
    \{n_{\,\text{low}}, n_{\,\text{high}} \} = N \, \times\, \{
\hat{\pi}_{\,\text{low}}, \hat{\pi}_{\,\text{high}} \}
\]</span> is then used as a <span class="math inline">\(100
(1-\alpha)\)</span>% confidence interval of the observed frequency <span class="math inline">\(n\)</span> which can be used to compare one
frequency to an expected or theoretical frequency. Such an unadjusted
confidence interval is termed a <em>stand-alone confidence interval</em>
<span class="citation">(Cousineau, Goulet, &amp; Harding,
2021)</span>.</p>
<p>As more commonly, we wish to compare an observed frequency to another
observed frequency, a <em>difference-adjusted</em> confidence interval
is sought. To obtain a difference-adjusted confidence interval, it is
required to multiply the interval width by 2, <span class="math display">\[
    n_{\,\text{low}}^* =  2(n-n_{\,\text{low}})+n
\]</span> <span class="math display">\[
    n_{\,\text{high}}^* =  2(n_{\,\text{high}}-n)+n
\]</span> where the asterisk denotes difference-adjusted confidence
interval limits. Thus, the interval<br><span class="math display">\[
    \{ n^*_{\,\text{low}}, n^*_{\,\text{high}} \}
\]</span> is the <em>difference-adjusted</em> <span class="math inline">\(100 (1-\alpha)\)</span>% confidence interval <span class="citation">(Baguley, 2012)</span>. The difference-adjusted
confidence intervals allow comparing the frequencies pairwise rather
than to a theoretical frequency.</p>
</div>
<div class="section level3">
<h3 id="why-multiply-the-stand-alone-ci-length-by-2">Why multiply the stand-alone CI length by 2?<a class="anchor" aria-label="anchor" href="#why-multiply-the-stand-alone-ci-length-by-2"></a>
</h3>
<p>The reason for the multiplication by 2 is two-fold. First, to obtain
a difference-adjusted confidence interval (CI), it is necessary to
multiply the CI width by <span class="math inline">\(\sqrt{2}\)</span>
(under the assumption of homogeneous variance). Second, as the total
must necessarily be equal to <span class="math inline">\(N\)</span>, the
observed frequencies are correlated and this correlation equals <span class="math inline">\(-1 / (C-1)\)</span> where <span class="math inline">\(C\)</span> is the number of class. As this CI is
meant for pair-wise comparisons, <span class="math inline">\(C\)</span>
is replaced by 2 in this formula, resulting in a second,
correlation-based, correction of <span class="math inline">\(\sqrt{1-r}
= \sqrt{1 - (-1/(2-1))} = \sqrt{2}\)</span>. As usual, both corrections
to the CI width are multiplicative.</p>
</div>
<div class="section level3">
<h3 id="one-illustration">One illustration<a class="anchor" aria-label="anchor" href="#one-illustration"></a>
</h3>
<p>To illustrate the method on a real data set, we enter the data set
found in <span class="citation">Light &amp; Margolin (1971)</span>. The
data counts the number of teenagers based (first factor) on their gender
an on (second factor) their educational vocation (the type of studies
they want to complete in the future). The sample is composed of 617
teens. To generate the dataset, we use the following:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    vocation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Secondary"</span>,<span class="st">"Vocational"</span>,<span class="st">"Teacher"</span>,<span class="st">"Gymnasium"</span>,<span class="st">"University"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">p</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Secondary"</span>,<span class="st">"Vocational"</span>,<span class="st">"Teacher"</span>,<span class="st">"Gymnasium"</span>,<span class="st">"University"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    gender  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Boys"</span>,<span class="st">"Girls"</span><span class="op">)</span>,<span class="fl">5</span><span class="op">)</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Boys"</span>,<span class="st">"Girls"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    obsfreq   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">62</span>,<span class="fl">61</span>,<span class="fl">121</span>,<span class="fl">149</span>,<span class="fl">26</span>,<span class="fl">41</span>,<span class="fl">33</span>,<span class="fl">20</span>,<span class="fl">84</span>,<span class="fl">20</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The function <code>factor</code> uses the argument
<code>levels</code> to specify the order in which the items are to be
plotted; otherwise, the default order is alphabetic order.</p>
<p>If you have the data in a file, it is actually a lot more easier to
import the file!</p>
<p>Here are the data <em>in extenso</em>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dta</span></span></code></pre></div>
<pre><code><span><span class="co">##      vocation gender obsfreq</span></span>
<span><span class="co">## 1   Secondary   Boys      62</span></span>
<span><span class="co">## 2   Secondary  Girls      61</span></span>
<span><span class="co">## 3  Vocational   Boys     121</span></span>
<span><span class="co">## 4  Vocational  Girls     149</span></span>
<span><span class="co">## 5     Teacher   Boys      26</span></span>
<span><span class="co">## 6     Teacher  Girls      41</span></span>
<span><span class="co">## 7   Gymnasium   Boys      33</span></span>
<span><span class="co">## 8   Gymnasium  Girls      20</span></span>
<span><span class="co">## 9  University   Boys      84</span></span>
<span><span class="co">## 10 University  Girls      20</span></span></code></pre>
<p>To have a quick-and-dirty plot, just display the raw counts with no
error bars</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dcousin3.github.io/superb/" class="external-link">superb</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span></span>
<span>    <span class="va">dta</span>,</span>
<span>    BSFactors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vocation"</span>,<span class="st">"gender"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="st">"obsfreq"</span>,                      <span class="co"># name of the column with the counts</span></span>
<span>    statistic <span class="op">=</span> <span class="st">"identity"</span>,                     <span class="co"># the raw data as is</span></span>
<span>    errorbar  <span class="op">=</span> <span class="st">"none"</span>,                         <span class="co"># no error bars</span></span>
<span>    <span class="co"># the following is for the look of the plot</span></span>
<span>    plotStyle      <span class="op">=</span> <span class="st">"line"</span>,                    <span class="co"># style of the plot</span></span>
<span>    lineParams     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>          <span class="co"># thicker lines as well</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plt1</span></span></code></pre></div>
<div class="figure">
<img src="VignetteF_files/figure-html/unnamed-chunk-4-1.png" alt="**Figure 1: A quick-and-dirty plot**" width="576"><p class="caption">
<strong>Figure 1: A quick-and-dirty plot</strong>
</p>
</div>
</div>
<div class="section level3">
<h3 id="define-the-confidence-interval-function">Define the confidence interval function<a class="anchor" aria-label="anchor" href="#define-the-confidence-interval-function"></a>
</h3>
<p>First, we need the summary function that computes the frequency. This
is actually the datum stored in the data frame, so there is nothing to
compute.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">count</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Second, we need an initalizer that will fetch the total sample size
<span class="math inline">\(N\)</span> and dump it in the global
environment for later use:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init.count</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">totalcount</span> <span class="op">&lt;&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">DV</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Third and lastly, we compute the confidence interval limits using
<span class="citation">Clopper &amp; Pearson (1934)</span> approach
using the <span class="citation">Leemis &amp; Trivedi (1996)</span>
analytic expression:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CI.count</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">gamma</span><span class="op">=</span><span class="fl">0.95</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">N</span> <span class="op">&lt;-</span> <span class="va">totalcount</span>    </span>
<span></span>
<span>    <span class="co"># Clopper &amp; Pearson CI from Leemis &amp; Trivedi, 1996</span></span>
<span>    <span class="va">plow</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">0</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">-</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">0</span><span class="op">)</span>,<span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">phig</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">+</span><span class="fl">0</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="va">gamma</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="va">n</span><span class="op">+</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span>    <span class="co"># convert to CI on counts</span></span>
<span>    <span class="va">nlow</span> <span class="op">&lt;-</span> <span class="va">totalcount</span> <span class="op">*</span> <span class="va">plow</span></span>
<span>    <span class="va">nhig</span> <span class="op">&lt;-</span> <span class="va">totalcount</span> <span class="op">*</span> <span class="va">phig</span></span>
<span></span>
<span>    <span class="co"># increase width for difference- and correlation-adjustments</span></span>
<span>    <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span> <span class="va">nlow</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">nhig</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">)</span> <span class="op">+</span> <span class="va">n</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This is it! All the statistical functions needed to make the plot are
in place.</p>
</div>
<div class="section level3">
<h3 id="make-a-count-plot-with-confidence-intervals">Make a count plot with confidence intervals<a class="anchor" aria-label="anchor" href="#make-a-count-plot-with-confidence-intervals"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span></span>
<span>    <span class="va">dta</span>,</span>
<span>    BSFactors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vocation"</span>,<span class="st">"gender"</span><span class="op">)</span>,</span>
<span>    variables <span class="op">=</span> <span class="st">"obsfreq"</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"count"</span>,                                 <span class="co"># the function defined above</span></span>
<span>    errorbar  <span class="op">=</span> <span class="st">"CI"</span>,                                    <span class="co"># its CI define above</span></span>
<span>    <span class="co"># the following is for the look of the plot</span></span>
<span>    plotStyle      <span class="op">=</span> <span class="st">"line"</span>,                             <span class="co"># style of the plot</span></span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> width <span class="op">=</span><span class="fl">0.5</span>, linewidth <span class="op">=</span><span class="fl">0.75</span> <span class="op">)</span>,<span class="co"># have thicker error bars</span></span>
<span>    lineParams     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> size <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span>                   <span class="co"># thicker lines as well</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plt2</span></span></code></pre></div>
<div class="figure">
<img src="VignetteF_files/figure-html/unnamed-chunk-8-1.png" alt="**Figure 2: A complete plot**" width="576"><p class="caption">
<strong>Figure 2: A complete plot</strong>
</p>
</div>
<p>The plot is drab so let’s add some ornaments to it:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ornate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Educational vocation"</span><span class="op">)</span>,                      <span class="co"># label on the x-axis</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Observed frequency"</span><span class="op">)</span>,                        <span class="co"># label on the y-axis</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,                          <span class="co"># black and white theme</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">guide_axis</a></span><span class="op">(</span>n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>  <span class="co"># unalign labels</span></span>
<span>    <span class="co"># etc. anything accepted by ggplots can be added.</span></span>
<span><span class="op">)</span></span>
<span><span class="va">plt3</span> <span class="op">&lt;-</span> <span class="va">plt2</span> <span class="op">+</span> <span class="va">ornate</span></span>
<span><span class="va">plt3</span></span></code></pre></div>
<div class="figure">
<img src="VignetteF_files/figure-html/unnamed-chunk-9-1.png" alt="**Figure 3: An ornated plot**" width="576"><p class="caption">
<strong>Figure 3: An ornated plot</strong>
</p>
</div>
</div>
<div class="section level3">
<h3 id="the-benefit-of-the-plot">The benefit of the plot<a class="anchor" aria-label="anchor" href="#the-benefit-of-the-plot"></a>
</h3>
<p>If you look at the plot, it becomes readily apparent that the boys
and the girls had (in the 1960s) the same educational aspirations. The
only exception is with regards to attending university where girls where
fewer to have this aspiration.</p>
<p>Now return to the data listed above, and tell me if you had noticed
that. <em>Most certainly not</em>. Tables are terribly inefficient tools
to convey trends whereas plots are ideal to that end. When combined with
a decent measure of error (here, the confidence interval), it is fairly
easy to decide if the trends are reliable or accidental.</p>
</div>
<div class="section level3">
<h3 id="are-we-sure">Are we sure?<a class="anchor" aria-label="anchor" href="#are-we-sure"></a>
</h3>
<p>The plot with <em>difference-adjusted</em> confidence interval is a
very reliable tool to make inference-by-eye. In doubt however, go run
the exact test. In the present case, we performed an ANOFA (Analysis of
Frequency datA; <span class="citation">Laurencelle &amp; Cousineau
(2023)</span>). It shows that the interaction is highly significant;
subsequent simple effect analyses show that this is indeed the
university aspiration that triggered that interaction.</p>
<p>ANOFA table:</p>
<table class="table">
<thead><tr class="header">
<th></th>
<th><span class="math inline">\(G\)</span></th>
<th>df</th>
<th><span class="math inline">\(G_{corrected}\)</span></th>
<th><span class="math inline">\(p\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Total</td>
<td>266.8894</td>
<td>9</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Aspiration (A)</td>
<td>215.0163</td>
<td>4</td>
<td>214.6684</td>
<td>&lt; 0.0001</td>
</tr>
<tr class="odd">
<td>Gender (B)</td>
<td>1.9865</td>
<td>1</td>
<td>1.9849</td>
<td>0.1589</td>
</tr>
<tr class="even">
<td>A <span class="math inline">\(\times\)</span> B</td>
<td>49.8867</td>
<td>4</td>
<td>49.5554</td>
<td>&lt; 0.0001</td>
</tr>
</tbody>
</table>
<p>Decomposition of the interaction and the Aspiration effects:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="52%">
<col width="13%">
<col width="4%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>Simple effect</th>
<th><span class="math inline">\(G\)</span></th>
<th>df</th>
<th><span class="math inline">\(G_{corrected}\)</span></th>
<th><span class="math inline">\(p\)</span></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Gender within Secondary school</td>
<td>0.0081</td>
<td>1</td>
<td>0.0081</td>
<td>0.9282</td>
</tr>
<tr class="even">
<td>Gender within Vocational training</td>
<td>2.9089</td>
<td>1</td>
<td>2.9078</td>
<td>0.0881</td>
</tr>
<tr class="odd">
<td>Gender within Teacher college</td>
<td>3.3868</td>
<td>1</td>
<td>3.3855</td>
<td>0.0658</td>
</tr>
<tr class="even">
<td>Gender within Gymnasium</td>
<td>3.2214</td>
<td>1</td>
<td>3.2201</td>
<td>0.0727</td>
</tr>
<tr class="odd">
<td>Gender within University</td>
<td>42.3478</td>
<td>1</td>
<td>42.3307</td>
<td>&lt;0.0001</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="in-summary">In summary<a class="anchor" aria-label="anchor" href="#in-summary"></a>
</h3>
<p>Frequencies, a.k.a. counts, can be displayed with appropriate
confidence intervals without any problem. They are just another regular
dependent variable in the researcher’s toolkit.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-b12" class="csl-entry">
Baguley, T. (2012). Calculating and graphing within-subject confidence
intervals for ANOVA. <em>Behavior Research Methods</em>, <em>44</em>,
158–175. <a href="https://doi.org/10.3758/s13428-011-0123-7" class="external-link">https://doi.org/10.3758/s13428-011-0123-7</a>
</div>
<div id="ref-c90" class="csl-entry">
Chen, H. (1990). The accuracy of approximate intervals for a binomial
parameter. <em>Journal of the American Statistical Association</em>,
<em>85</em>, 514–518. <a href="https://doi.org/10.2307/2289792" class="external-link">https://doi.org/10.2307/2289792</a>
</div>
<div id="ref-cp34" class="csl-entry">
Clopper, C. J., &amp; Pearson, E. S. (1934). The use of confidence or
fiducial limits illustrated in the case of the binomial.
<em>Biometrika</em>, <em>26</em>, 404–413. <a href="https://doi.org/10.1093/biomet/26.4.404" class="external-link">https://doi.org/10.1093/biomet/26.4.404</a>
</div>
<div id="ref-cgh21" class="csl-entry">
Cousineau, D., Goulet, M.-A., &amp; Harding, B. (2021). Summary plots
with adjusted error bars: The superb framework with an implementation in
<span>R</span>. <em>Advances in Methods and Practices in Psychological
Science</em>, <em>4</em>, 1–18. <a href="https://doi.org/10.1177/25152459211035109" class="external-link">https://doi.org/10.1177/25152459211035109</a>
</div>
<div id="ref-lc23b" class="csl-entry">
Laurencelle, L., &amp; Cousineau, D. (2023). Analysis of frequency
tables: The ANOFA framework. <em>The Quantitative Methods for
Psychology</em>, <em>19</em>, 173–193. <a href="https://doi.org/10.20982/tqmp.19.2.p173" class="external-link">https://doi.org/10.20982/tqmp.19.2.p173</a>
</div>
<div id="ref-lt96" class="csl-entry">
Leemis, L. M., &amp; Trivedi, K. S. (1996). A comparison of approximate
interval estimators for the bernoulli parameter. <em>The American
Statistician</em>, <em>50</em>(1), 63–68.
</div>
<div id="ref-lm71" class="csl-entry">
Light, R. J., &amp; Margolin, B. H. (1971). An analysis of variance for
categorical data. <em>Journal of the American Statistical
Association</em>, <em>66</em>, 534–544. <a href="https://doi.org/10.1080/01621459.1971.10482297" class="external-link">https://doi.org/10.1080/01621459.1971.10482297</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
