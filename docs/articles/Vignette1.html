<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Three steps to make your plot • superb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Three steps to make your plot">
<meta property="og:description" content="This vignette reviews the steps needed to realize your summary plot with correct error bars.
">
<meta property="og:image" content="http://dcousin3.github.io/superb/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Three steps to make your plot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/../vignettes/Vignette1.Rmd" class="external-link"><code>../vignettes/Vignette1.Rmd</code></a></small>
      <div class="hidden name"><code>Vignette1.Rmd</code></div>

    </div>

    
    
<p>The package <code>superb</code> facilitates the production of summary
statistic plots having adjusted error bars <span class="citation">(Cousineau, Goulet, &amp; Harding, 2021)</span>. Error
bars are measures of precision; they are meant to convey some
indications of the trust we can place in a given result. Those results
that come will large error bars (wide intervals) should be considered
less reliable that those with short error bars.</p>
<p>Error bars, which are drawn from measures of precision, comes in many
flavors. There is the simple <em>standard error</em> (SE), the more
famous <em>confidence interval</em> (CI), and new proposals such as the
<em>highest density interval</em> (HDI). The package <code>superb</code>
has build-in functions for both the SE and CI, but any other measure of
precision can be added (as shown in <a href="https://dcousin3.github.io/superb/articles/Vignette4.html" class="external-link">Vignette
4</a>).</p>
<p>All measures of precision are tailored for a given statistic. Hence,
we have the <em>standard error of the mean</em>, the <em>standard error
of the median</em>, the <em>confidence interval of the skew</em>, etc.
For each and every statistic, there is a corresponding measure of
precision. In what follows, we discuss the confidence interval, but
everything that follows apply equally well to any measure of
precision.</p>
<p>The basic confidence interval can be termed a “stand-alone”
confidence interval because it indicates the precision of a statistic in
isolation. It is useful to compare this statistics to a criterion
performance or any <em>a priori</em>-determined value. As shown in <a href="https://dcousin3.github.io/superb/articles/Vignette2.html" class="external-link">Vignette
2</a> and <a href="https://dcousin3.github.io/superb/articles/Vignette3.html" class="external-link">Vignette
3</a>, such “stand-alone” measures are inadequate when an observed
result is to be compared to other observed results <span class="citation">(also see Cousineau, 2005, 2017)</span>.</p>
<p>In order to use <code>superb</code>, four choices need to be made,
described next. Prior to that, it is necessary to check the data format.
Herein we illustrate the means with 95% confidence intervals; these can
be changed, as shown in <a href="https://dcousin3.github.io/superb/articles/Vignette4.html" class="external-link">Vignette
4</a>.</p>
<div class="section level3">
<h3 id="data-format">Data format<a class="anchor" aria-label="anchor" href="#data-format"></a>
</h3>
<p>The format of the data in <code>superb</code> follows the general
convention “1 subject = 1 line”, that is, all the information regarding
a given participant must stand on a single line. This format is called
in R the <strong>wide format</strong>; in SPSS, SAS and other statistics
software, this is the standard data organization. Further, the data must
be contained within a <code>data.frame</code> with named columns. It is
easy to go from <strong>wide format</strong> to <strong>long
format</strong>, with, e.g., Navarro’s <code>wideToLong</code> excellent
function <span class="citation">(Navarro, 2015)</span>.</p>
<p>As an illustration, we use the following ficticious data set showing
the performance of 15 participants on their motivation scores on Week 1,
Week 2 and Week 3 for a program to stop smoking.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Motivation data for 15 participants over three weeks in wide format:</span></span>
<span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">45</span>, <span class="fl">50</span>,  <span class="fl">59</span>,</span>
<span>    <span class="fl">47</span>, <span class="fl">58</span>,  <span class="fl">64</span>,</span>
<span>    <span class="fl">53</span>, <span class="fl">63</span>,  <span class="fl">72</span>,</span>
<span>    <span class="fl">57</span>, <span class="fl">64</span>,  <span class="fl">81</span>,</span>
<span>    <span class="fl">58</span>, <span class="fl">67</span>,  <span class="fl">86</span>,</span>
<span>    <span class="fl">61</span>, <span class="fl">70</span>,  <span class="fl">98</span>,</span>
<span>    <span class="fl">61</span>, <span class="fl">75</span>, <span class="fl">104</span>,</span>
<span>    <span class="fl">63</span>, <span class="fl">79</span>, <span class="fl">100</span>,</span>
<span>    <span class="fl">63</span>, <span class="fl">79</span>,  <span class="fl">84</span>,</span>
<span>    <span class="fl">71</span>, <span class="fl">81</span>,  <span class="fl">96</span>,</span>
<span>    <span class="fl">72</span>, <span class="fl">83</span>,  <span class="fl">82</span>,</span>
<span>    <span class="fl">74</span>, <span class="fl">84</span>,  <span class="fl">82</span>,</span>
<span>    <span class="fl">76</span>, <span class="fl">86</span>,  <span class="fl">93</span>,</span>
<span>    <span class="fl">84</span>, <span class="fl">90</span>,  <span class="fl">85</span>,</span>
<span>    <span class="fl">90</span>, <span class="fl">96</span>,  <span class="fl">89</span></span>
<span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># put column names then convert to data.frame:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">dta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span><span class="op">)</span></span>
<span><span class="va">dta</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">dta</span><span class="op">)</span></span></code></pre></div>
<p>The mean scores per week is illustrated below:</p>
<div class="figure">
<img src="Vignette1_files/figure-html/unnamed-chunk-3-1.png" alt="**Figure 1**. Mean scores along with 95% confidence interval per week for a program to stop smoking." width="384"><p class="caption">
<strong>Figure 1</strong>. Mean scores along with 95% confidence
interval per week for a program to stop smoking.
</p>
</div>
<p>Note that missing data are not handled by <code>superb</code>. The
cells with NA must be removed or imputed prior to perform the plot.</p>
</div>
<div class="section level3">
<h3 id="step-1-decide-of-the-purpose-of-the-plot">Step 1: Decide of the purpose of the plot<a class="anchor" aria-label="anchor" href="#step-1-decide-of-the-purpose-of-the-plot"></a>
</h3>
<p>In Figure 1 above, did you look at the result of, say, Week 1, in
isolation? or did you compare it to the results obtained in the other
weeks? The second perspective is actually to look at the
<strong>difference</strong> between the results. if such is the case,
the error bar shown on this plot are actually misleading because they
are too short. The reason for that is further explored in <a href="https://dcousin3.github.io/superb/articles/Vignette2.html" class="external-link">Vignette
2</a>.</p>
<p>In most experiments, one condition is <strong>compared</strong> to
other conditions. In that case, we are interested in
<strong>pair-wise</strong> differences between means, not by single
results in isolation. Yet, the regular confidence intervals are valid
only for results in isolation. Whenever you wish to compare a result to
other results, to examine differences between conditions (which is, most
of the time), you need to adjust the confidence interval lengths so that
they remain adequate inference tools.</p>
<p>In <code>superb</code>, you obtain an adjustment to error bar length
with an option for the purpose of the plot. The default
<code>purpose = "single"</code> returns stand-alone error bars (as in
Figure 1); <code>purpose = "difference"</code> returns error bars valid
for pair-wise comparisons. The minimum specification for the data frame
above would therefore be</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"Moment(3)"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span><span class="op">)</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,</span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Vignette1_files/figure-html/unnamed-chunk-5-1.png" alt="**Figure 2**. Mean scores along with difference-adjusted 95% confidence interval per week for a program to stop smoking." width="384"><p class="caption">
<strong>Figure 2</strong>. Mean scores along with difference-adjusted
95% confidence interval per week for a program to stop smoking.
</p>
</div>
<p>The first argument is the data.frame, in wide format (here
<code>dta</code>). The second argument describe the experimental design.
Here, there is a single within-subject factor (<code>WSFactors</code>),
called <code>Moment</code>. In within-subject factors, it is necessary
to indicate how many level the factor has (here 3). The third argument
indicates the columns in the data.frame containing the measurements.
Three columns are involved. The name must match the column names in the
data.frame. If unsure, check with</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dta</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   Week 1 Week 2 Week 3</span></span>
<span><span class="co">## 1     45     50     59</span></span>
<span><span class="co">## 2     47     58     64</span></span>
<span><span class="co">## 3     53     63     72</span></span>
<span><span class="co">## 4     57     64     81</span></span>
<span><span class="co">## 5     58     67     86</span></span>
<span><span class="co">## 6     61     70     98</span></span></code></pre>
<p>The argument in which the adjustments will be listed is called
<code>adjustments</code> which is a list with —for the moment— an
adjustment for the purpose of the plot:
<code>purpose =  "difference"</code>. The standalone CI is the default
(it can be obtained explicitly with <code>purpose= "single"</code>).
These two expressions, <em>single</em> and <em>difference</em>, are from
<span class="citation">Baguley (2012)</span>.</p>
<p>Note that the plot obtained is a <code>ggplot</code> object to which
additional graphing directives can be added. Figure 2 was actually
obtained with these commands:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"Moment(3)"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"mean"</span>, errorbar <span class="op">=</span> <span class="st">"CI"</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span><span class="op">)</span>,</span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mean +- 95% CI"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Difference-adjusted\n95% confidence interval"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Week 1"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Week 2"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"Week 3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The graphic directives are applied to the whole plot. The reader is
referred to the package <code>ggplot2</code> for more on these graphing
directives.</p>
</div>
<div class="section level3">
<h3 id="step-2-decide-how-to-handle-the-within-subject-measures">Step 2: Decide how to handle the within-subject measures<a class="anchor" aria-label="anchor" href="#step-2-decide-how-to-handle-the-within-subject-measures"></a>
</h3>
<p>Is is known that within-subject designs are generally more powerful
at detecting differences. The implication of this is that they afford
more statistical power and consequently the error bars should be
shorter. The stand-alone CI are oblivious to this fact; it is however
possible to inform them that you used a within-subject design.</p>
<p>The method to handle within-subject data comes from the observation
that repeated measures tend to be correlated <span class="citation">(e.g., Goulet &amp; Cousineau, 2019)</span>. Informing
the CI of this correlation is a process called
<strong>decorrelation</strong>. To this day, there exists three methods
for decorrelation:</p>
<ul>
<li>
<code>CM</code>: this method, called from the two authors Cousineau
and Morey <span class="citation">(Cousineau, 2005; Morey, 2008)</span>,
will decorrelate the data but each measurement may have different
adjustments;</li>
<li>
<code>LM</code>: this method, the first developed by Loftus and
Masson <span class="citation">(1994)</span>, will make all the error
bars have the same length;</li>
<li>
<code>CA</code>: this method, called <em>correlation-based
adjustment</em> was proposed in <span class="citation">Cousineau
(2019)</span>. As per CM, the error bars can be different in
length.</li>
</ul>
<p>The three methods were compared in <span class="citation">Cousineau
(2019)</span> and shown to be mathematically based on the same concepts
and estimating the same precision. It is therefore a matter of personal
preference which one you use.</p>
<p>Figure 2 above will become Figure 3 if you add a decorrelation
adjustment:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"Moment(3)"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="st">"mean"</span>, errorbar <span class="op">=</span> <span class="st">"CI"</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CM"</span><span class="op">)</span>, <span class="co">#new!</span></span>
<span>    plotStyle<span class="op">=</span><span class="st">"line"</span>,</span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mean +- 95% CI"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Correlation- and Difference-adjusted\n95% confidence interval"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Week 1"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Week 2"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"Week 3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## superb::FYI: The HyunhFeldtEpsilon measure of sphericity per group are  0.545</span></span></code></pre>
<pre><code><span><span class="co">## superb::FYI: Some of the groups' data are not spherical. Use error bars with caution.</span></span></code></pre>
<p><img src="Vignette1_files/figure-html/unnamed-chunk-8-1.png" width="384"></p>
<p>Unless you change the options to
<code>options(superb.feedback = 'none')</code>, the command will issue
some additional information. In the present data set, <span class="math inline">\(\varepsilon\)</span> is 0.54 which is low. A
Mauchly test of sphericity indicates rejection of sphericity, so
interpret the error bars with caution. All the messages issued beginning
with <code>"FYI"</code> are just information. Hereafter, the warnings
are inhibited.</p>
</div>
<div class="section level3">
<h3 id="step-3-specify-the-sampling-procedure-and-the-population-size">Step 3: Specify the sampling procedure and the population size<a class="anchor" aria-label="anchor" href="#step-3-specify-the-sampling-procedure-and-the-population-size"></a>
</h3>
<p>The stand-alone confidence intervals are appropriate when your sample
was obtained randomly, a method formally called <em>Simple Randomize
Sampling</em> (SRS). However, this is not the only sampling method
possible. Another commonly employed sampling procedure is cluster
sampling (formally <em>Cluster Randomized Sampling</em>, CRS). The CRS
is the only one (beyond SRS) where the exact adjustment is known <span class="citation">(Cousineau &amp; Laurencelle, 2016)</span> and thus SRS
(no adjustment) and CRS (adjustments that tend to widen the error bars)
are the only two sampling adjustments currently implemented in
<code>superb</code>.</p>
<p>Other sampling methods includes <em>Stratified Sampling</em>,
<em>Snowball Sampling</em>, <em>Convenience Sampling</em>, etc., none of
which have a known impact on the precision of the measures.</p>
<p>Also, determine if the population size is finite or infinite. When
the population under scrutiny is finite, you may have a sizeable
proportion of the population in your sample, which improves precision.
In this case, the error bars will be shortened.</p>
<p>These adjustments are implemented in <code>superb</code> with
additional adjustments, such as</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add (ficticious) cluster membership for each participant in the column "cluster"</span></span>
<span><span class="va">dta</span><span class="op">$</span><span class="va">cluster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/superbPlot.html">superbPlot</a></span><span class="op">(</span><span class="va">dta</span>, </span>
<span>    WSFactors <span class="op">=</span> <span class="st">"Moment(3)"</span>,</span>
<span>    variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Week 1"</span>, <span class="st">"Week 2"</span>, <span class="st">"Week 3"</span><span class="op">)</span>,</span>
<span>    adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CM"</span>,</span>
<span>                       samplingDesign <span class="op">=</span> <span class="st">"CRS"</span>, popSize <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,        <span class="co">#new!</span></span>
<span>    plotStyle <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>    clusterColumn <span class="op">=</span> <span class="st">"cluster"</span>,  <span class="co"># identify the column containing cluster membership</span></span>
<span>    errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>,<span class="fl">100</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Mean +- 95% CI"</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Cluster- Correlation, and Difference-adjusted\n95% confidence interval"</span><span class="op">)</span><span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_gray</a></span><span class="op">(</span>base_size<span class="op">=</span><span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span> <span class="op">=</span> <span class="st">"Week 1"</span>, <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Week 2"</span>, <span class="st">"3"</span><span class="op">=</span><span class="st">"Week 3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Vignette1_files/figure-html/unnamed-chunk-10-1.png" width="384"></p>
<p>As you can see, the adjustments can be obtained with a single option
inside the <code>adjustments</code> list. They are cumulative, i.e.,
more than one adjustment can be used, depending on the situation.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-b12" class="csl-entry">
Baguley, T. (2012). Calculating and graphing within-subject confidence
intervals for ANOVA. <em>Behavior Research Methods</em>, <em>44</em>,
158–175. <a href="https://doi.org/10.3758/s13428-011-0123-7" class="external-link">https://doi.org/10.3758/s13428-011-0123-7</a>
</div>
<div id="ref-c05" class="csl-entry">
Cousineau, D. (2005). Confidence intervals in within-subject designs: A
simpler solution to <span>L</span>oftus and <span>M</span>asson’s
method. <em>Tutorials in Quantitative Methods for Psychology</em>,
<em>1</em>, 42–45. <a href="https://doi.org/10.20982/tqmp.01.1.p042" class="external-link">https://doi.org/10.20982/tqmp.01.1.p042</a>
</div>
<div id="ref-c17" class="csl-entry">
Cousineau, D. (2017). Varieties of confidence intervals. <em>Advances in
Cognitive Psychology</em>, <em>13</em>, 140–155. <a href="https://doi.org/10.5709/acp-0214-z" class="external-link">https://doi.org/10.5709/acp-0214-z</a>
</div>
<div id="ref-c19" class="csl-entry">
Cousineau, D. (2019). Correlation-adjusted standard errors and
confidence intervals for within-subject designs: A simple multiplicative
approach. <em>The Quantitative Methods for Psychology</em>, <em>15</em>,
226–241. <a href="https://doi.org/10.20982/tqmp.15.3.p226" class="external-link">https://doi.org/10.20982/tqmp.15.3.p226</a>
</div>
<div id="ref-cgh21" class="csl-entry">
Cousineau, D., Goulet, M.-A., &amp; Harding, B. (2021). Summary plots
with adjusted error bars: The superb framework with an implementation in
<span>R</span>. <em>Advances in Methods and Practices in Psychological
Science</em>, <em>4</em>, 1–18. <a href="https://doi.org/10.1177/25152459211035109" class="external-link">https://doi.org/10.1177/25152459211035109</a>
</div>
<div id="ref-cl16" class="csl-entry">
Cousineau, D., &amp; Laurencelle, L. (2016). A correction factor for the
impact of cluster randomized sampling and its applications.
<em>Psychological Methods</em>, <em>21</em>, 121–135. <a href="https://doi.org/10.1037/met0000055" class="external-link">https://doi.org/10.1037/met0000055</a>
</div>
<div id="ref-gc19" class="csl-entry">
Goulet, M.-A., &amp; Cousineau, D. (2019). The power of replicated
measures to increase statistical power. <em>Advances in Methods and
Practices in Psychological Sciences</em>, <em>Online</em>, 1–15. <a href="https://doi.org/10.1177/2515245919849434" class="external-link">https://doi.org/10.1177/2515245919849434</a>
</div>
<div id="ref-lm94" class="csl-entry">
Loftus, G. R., &amp; Masson, M. E. J. (1994). Using confidence intervals
in within-subject designs. <em>Psychonomic Bulletin &amp; Review</em>,
<em>1</em>, 476–490. <a href="https://doi.org/10.3758/BF03210951" class="external-link">https://doi.org/10.3758/BF03210951</a>
</div>
<div id="ref-m08" class="csl-entry">
Morey, R. D. (2008). Confidence intervals from normalized data: A
correction to <span>C</span>ousineau (2005). <em>Tutorials in
Quantitative Methods for Psychology</em>, <em>4</em>, 61–64. <a href="https://doi.org/10.20982/tqmp.04.2.p061" class="external-link">https://doi.org/10.20982/tqmp.04.2.p061</a>
</div>
<div id="ref-n15" class="csl-entry">
Navarro, D. (2015). Learning statistics with <span>R</span>: A tutorial
for psychology students and other beginners. (Version 0.5). Retrieved
from <a href="https://learningstatisticswithr.com/" class="external-link">https://learningstatisticswithr.com/</a>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
