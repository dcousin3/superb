<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Confidence intervals with custom degree of freedom — precisionMeasureWithCustomDF • superb</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence intervals with custom degree of freedom — precisionMeasureWithCustomDF"><meta property="og:description" content="The following function computes a confidence interval with
custom degree of freedom. The default is to use N-1 but this number is not
quite appropriate. To get the exact critical value which is used to construct
the confidence interval, it is necessary to ``pool'' the degrees of freedom.
This last expression means that the degree of freedom is the total number of
data minus 1 for each condition except the last, and minus 1 for each participant
except the last. In formula, if the number of repeated measures is $p$,
the number of participants is $n$, and the total sample size is $N$ (with
$N = p x n$, then the
pooled degree of freedom is $(p-1) x (n-1)$ or equivalently $N -p-n+1$.
Another example where custom degree of freedom can be used is when there are
heterogeneous variances,
the confidence interval of the mean should mirror a Welsh test where the
degrees of freedom are altered based on variances. The function CIwithDF.mean()
accept any arbitrary defined degree of freedom (df).
The df must be combined to the argument `gamma` after the confidence level."><meta property="og:image" content="http://dcousin3.github.io/superb/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.22</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteH.html">Plotting radar plots for illustrating profiles</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence intervals with custom degree of freedom</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/R/functionsStatistical.R" class="external-link"><code>R/functionsStatistical.R</code></a></small>
    <div class="hidden name"><code>precisionMeasureWithCustomDF.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The following function computes a confidence interval with
custom degree of freedom. The default is to use N-1 but this number is not
quite appropriate. To get the exact critical value which is used to construct
the confidence interval, it is necessary to ``pool'' the degrees of freedom.
This last expression means that the degree of freedom is the total number of
data minus 1 for each condition except the last, and minus 1 for each participant
except the last. In formula, if the number of repeated measures is $p$,
the number of participants is $n$, and the total sample size is $N$ (with
$N = p x n$, then the
pooled degree of freedom is $(p-1) x (n-1)$ or equivalently $N -p-n+1$.
Another example where custom degree of freedom can be used is when there are
heterogeneous variances,
the confidence interval of the mean should mirror a Welsh test where the
degrees of freedom are altered based on variances. The function <code>CIwithDF.mean()</code>
accept any arbitrary defined degree of freedom (df).
The df must be combined to the argument `gamma` after the confidence level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CIwithDF.mean</span><span class="op">(</span><span class="va">x</span>, gamma <span class="op">=</span> <span class="fl">0.95</span> <span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a vector of numbers, the sample data (mandatory);</p></dd>


<dt>gamma</dt>
<dd><p>a vector containing first a confidence level for CI (default 0.95) and
a custom degree of freedom (when unspecified, it uses <code>n-1</code> where <code>n</code> is the number
of observations in each of the condition).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>the confidence interval (CI) where the <code>t</code> value is based on the custom-set degree of freedom.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>See the vignette "Unequal variances, Welch test, Tryon adjustment, and superb"
for an example of use.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>There are no references for Rd macro <code>\insertAllCites</code> on this help page.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># this will issue a warning as no custom degree of freedom (df) is provided</span></span></span>
<span class="r-in"><span><span class="fu">CIwithDF.mean</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, gamma <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>          </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>superb::FYI: No degree of freedom provided in gamma[2]; revert to CI.mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.3141455 3.6858545</span>
<span class="r-in"><span><span class="co"># the confidence interval of the mean for 90% confidence level</span></span></span>
<span class="r-in"><span><span class="fu">CIwithDF.mean</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>, gamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">1.5</span><span class="op">)</span> <span class="op">)</span> <span class="co"># uses 1.5 as df instead of 2.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.1391871  4.1391871</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================</span></span></span>
<span class="r-in"><span><span class="co"># A COMPLETE EXAMPLE: </span></span></span>
<span class="r-in"><span><span class="co"># ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Let's generate random measurements with GRD:</span></span></span>
<span class="r-in"><span><span class="co"># (we generate a very small group of 10 to have a chance to see differences)</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="GRD.html">GRD</a></span><span class="op">(</span> WSFactors <span class="op">=</span> <span class="st">"Moment (3)"</span>, SubjectsPerGroup <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We need ggplotGrop</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First, a regular plot</span></span></span>
<span class="r-in"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">DV.1</span>,<span class="va">DV.2</span>,<span class="va">DV.3</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, </span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           WSFactors      <span class="op">=</span> <span class="st">"Moment(3)"</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span>,decorrelation<span class="op">=</span><span class="st">"CM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CI"</span>,</span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"orange"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>                                 position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Second, a plot where the df are set to the default</span></span></span>
<span class="r-in"><span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">DV.1</span>,<span class="va">DV.2</span>,<span class="va">DV.3</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           WSFactors      <span class="op">=</span> <span class="st">"Moment(3)"</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span>,decorrelation<span class="op">=</span><span class="st">"CM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CIwithDF"</span>,    <span class="co"># NEW: change the CI computation </span></span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">10</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># NEW: specify explicitely the unpooled df</span></span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"left"</span>,</span></span>
<span class="r-in"><span>                                   position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Third, a plot where the pooled df are explicitely set </span></span></span>
<span class="r-in"><span><span class="va">plt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">DV.1</span>,<span class="va">DV.2</span>,<span class="va">DV.3</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>,</span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           WSFactors      <span class="op">=</span> <span class="st">"Moment(3)"</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span>,decorrelation<span class="op">=</span><span class="st">"CM"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CIwithDF"</span>,         <span class="co"># NEW: again, change the CI computation</span></span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">30</span><span class="op">-</span><span class="fl">3</span><span class="op">-</span><span class="fl">10</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># NEW: this time, specify the pooled df</span></span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>                                 position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">+</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span> </span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Convert the plots into grapphical objects all with the same scale...</span></span></span>
<span class="r-in"><span><span class="va">plt1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.65</span>,<span class="fl">1.65</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plt2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.65</span>,<span class="fl">1.65</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="makeTransparent.html">makeTransparent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plt3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.65</span>,<span class="fl">1.65</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="makeTransparent.html">makeTransparent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... and superimpose these grobs onto an empty ggplot </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt1b</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt2b</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt3b</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="precisionMeasureWithCustomDF-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As seen and as expected, the orange and red bars are identical; </span></span></span>
<span class="r-in"><span><span class="co"># The blue bars, based on the (correct) pooled degree of freedom</span></span></span>
<span class="r-in"><span><span class="co"># are just a little bit smaller because the pooled df are larger.</span></span></span>
<span class="r-in"><span><span class="co"># However, the difference is visible only because the group size</span></span></span>
<span class="r-in"><span><span class="co"># is ridiculously small (10 participants only).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================</span></span></span>
<span class="r-in"><span><span class="co"># AN EXAMPLE with heterogeneous variance</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># We create simulated scores with a large amount of heterogeneity</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="GRD.html">GRD</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>     BSFactors <span class="op">=</span> <span class="st">"Group(3)"</span>,</span></span>
<span class="r-in"><span>     SubjectsPerGroup <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>     Population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         mean   <span class="op">=</span> <span class="fl">100</span>, <span class="co"># will set GM to 100</span></span></span>
<span class="r-in"><span>         stddev <span class="op">=</span> <span class="fl">15</span>,  <span class="co"># will set STDDEV to 15</span></span></span>
<span class="r-in"><span>         scores <span class="op">=</span> <span class="st">"rnorm(1, mean = GM, sd = STDDEV*Group)"</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This computes the Welch's degree of freedom</span></span></span>
<span class="r-in"><span><span class="va">wdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="WelchDegreeOfFreedom.html">WelchDegreeOfFreedom</a></span><span class="op">(</span><span class="va">dta</span>, <span class="st">"DV"</span>, <span class="st">"Group"</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wdf</span> <span class="co"># should be between n-1 and N-n-p+1.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 17.56551</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A regular plot</span></span></span>
<span class="r-in"><span><span class="va">plt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>           <span class="va">DV</span> <span class="op">~</span> <span class="va">Group</span>,</span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CI"</span>,</span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fl">0.95</span>, </span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"orange"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"both"</span>,</span></span>
<span class="r-in"><span>                                 position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.0</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Second, a plot where the df are set to the pooled df</span></span></span>
<span class="r-in"><span><span class="va">plt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span>           <span class="va">DV</span> <span class="op">~</span> <span class="va">Group</span>,</span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CIwithDF"</span>,         <span class="co"># NEW: change the CI computation </span></span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">30</span><span class="op">-</span><span class="fl">10</span><span class="op">-</span><span class="fl">3</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="co"># NEW: specify explicitely the unpooled df</span></span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"red"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"left"</span>,</span></span>
<span class="r-in"><span>                                   position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Third, a plot where the pooled df are explicitely set </span></span></span>
<span class="r-in"><span><span class="va">plt3</span> <span class="op">&lt;-</span> <span class="fu"><a href="superb.html">superb</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span>           <span class="va">DV</span> <span class="op">~</span> <span class="va">Group</span>,</span></span>
<span class="r-in"><span>           <span class="va">dta</span>, </span></span>
<span class="r-in"><span>           plotLayout     <span class="op">=</span> <span class="st">"line"</span>,</span></span>
<span class="r-in"><span>           adjustments    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span> <span class="op">(</span>purpose<span class="op">=</span><span class="st">"difference"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           errorbar       <span class="op">=</span> <span class="st">"CIwithDF"</span>,       <span class="co"># NEW: again, change the CI computation</span></span></span>
<span class="r-in"><span>           gamma          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="va">wdf</span><span class="op">)</span>,     <span class="co"># NEW: this time, specify the pooled df</span></span></span>
<span class="r-in"><span>           errorbarParams <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"blue"</span>, width<span class="op">=</span> <span class="fl">0.1</span>, direction <span class="op">=</span> <span class="st">"right"</span>,</span></span>
<span class="r-in"><span>                                 position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_nudge.html" class="external-link">position_nudge</a></span><span class="op">(</span><span class="op">+</span><span class="fl">0.05</span><span class="op">)</span> <span class="op">)</span> </span></span>
<span class="r-in"><span>        <span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Convert the plots into grapphical objects all with the same scale...</span></span></span>
<span class="r-in"><span><span class="va">plt1b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">175</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plt2b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">175</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="makeTransparent.html">makeTransparent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">plt3b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplotGrob.html" class="external-link">ggplotGrob</a></span><span class="op">(</span><span class="va">plt3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">25</span>,<span class="fl">175</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="makeTransparent.html">makeTransparent</a></span><span class="op">(</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ... and superimpose these grobs onto an empty ggplot </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt1b</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt2b</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotation_custom.html" class="external-link">annotation_custom</a></span><span class="op">(</span>grob<span class="op">=</span><span class="va">plt3b</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="precisionMeasureWithCustomDF-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># As seen, the Welch's corrected df results in error bars (blue) which are </span></span></span>
<span class="r-in"><span><span class="co"># just a little bit longer than the pooled df bars (red). In all cases, the</span></span></span>
<span class="r-in"><span><span class="co"># unadjusted (default) error bars (n-1) are longer (orange bars), resulting in a more </span></span></span>
<span class="r-in"><span><span class="co"># conservative representation of the data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

