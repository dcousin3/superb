<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>superb — superb • superb</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="superb — superb"><meta property="og:description" content="The function superb() plots standard error or confidence interval for
various descriptive statistics under various designs, sampling schemes,
population size and purposes, according to the superb framework.
See cgh21superb for more.
The functions superb() is now the entry point
to realize summary plots.
Compared to the previously documented superbPlot(),
superb() is based on formula and accept
long and wide format."><meta property="og:image" content="http://dcousin3.github.io/superb/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">superb</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.95.99</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Vignette1.html">Three steps to make your plot</a>
    </li>
    <li>
      <a href="../articles/Vignette2.html">Why use difference-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette3.html">Why use correlation-adjusted confidence intervals?</a>
    </li>
    <li>
      <a href="../articles/Vignette9.html">Plotting Cohen's d with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteC.html">Plotting proportions with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteF.html">Plotting frequencies using ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteA.html">Plotting Reference Intervals with ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteH.html">Plotting radar plots for illustrating profiles</a>
    </li>
    <li>
      <a href="../articles/TheMakingOf.html">The making-of the figures in the article</a>
    </li>
    <li>
      <a href="../articles/CustomizingSuperbPlots.html">Customizing `superb` plots</a>
    </li>
    <li>
      <a href="../articles/VignetteE.html">Adding labels to ``superb`` plots</a>
    </li>
    <li>
      <a href="../articles/Vignette7.html">Unequal variances, Welch test, Tryon adjustment, and ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette8.html">(advanced) Alternate ways to decorrelate repeated measures from transformations</a>
    </li>
    <li>
      <a href="../articles/VignetteG.html">(advanced) Local decorrelation for time series</a>
    </li>
    <li>
      <a href="../articles/VignetteB.html">(advanced) Non-factorial within-subject designs in ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette4.html">Using a custom statistic with its error bar within ``superb``</a>
    </li>
    <li>
      <a href="../articles/Vignette5.html">Using a custom plot layout within ``superb``</a>
    </li>
    <li>
      <a href="../articles/VignetteD.html">``superb`` and SPSS</a>
    </li>
    <li>
      <a href="../articles/Vignette6.html">Generating ready-to-analyze datasets with GRD</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dcousin3/superb/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>superb</h1>
    <small class="dont-index">Source: <a href="https://github.com/dcousin3/superb/blob/HEAD/R/superb.R" class="external-link"><code>R/superb.R</code></a></small>
    <div class="hidden name"><code>superb.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code>superb()</code> plots standard error or confidence interval for
various descriptive statistics under various designs, sampling schemes,
population size and purposes, according to the <code>superb</code> framework.
See cgh21superb for more.
The functions <code>superb()</code> is now the entry point
to realize summary plots.
Compared to the previously documented <code><a href="superbPlot.html">superbPlot()</a></code>,
<code>superb()</code> is based on formula and accept
long and wide format.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">superb</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  WSFactors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  WSDesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factorOrder <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  statistic <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>  errorbar <span class="op">=</span> <span class="st">"CI"</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"single"</span>, popSize <span class="op">=</span> <span class="cn">Inf</span>, decorrelation <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>    samplingDesign <span class="op">=</span> <span class="st">"SRS"</span><span class="op">)</span>,</span>
<span>  showPlot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plotStyle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plotLayout <span class="op">=</span> <span class="st">"line"</span>,</span>
<span>  preprocessfct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  postprocessfct <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  clusterColumn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a formula describing the design of the data frame</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Dataframe in wide or long format</p></dd>


<dt id="arg-wsfactors">WSFactors<a class="anchor" aria-label="anchor" href="#arg-wsfactors"></a></dt>
<dd><p>The name of the within-subject factor(s)</p></dd>


<dt id="arg-wsdesign">WSDesign<a class="anchor" aria-label="anchor" href="#arg-wsdesign"></a></dt>
<dd><p>the within-subject design if not a full factorial design (default "fullfactorial")</p></dd>


<dt id="arg-factororder">factorOrder<a class="anchor" aria-label="anchor" href="#arg-factororder"></a></dt>
<dd><p>Order of factors as shown in the graph (in that order: x axis,
groups, horizontal panels, vertical panels)</p></dd>


<dt id="arg-statistic">statistic<a class="anchor" aria-label="anchor" href="#arg-statistic"></a></dt>
<dd><p>The summary statistic function to use as a string</p></dd>


<dt id="arg-errorbar">errorbar<a class="anchor" aria-label="anchor" href="#arg-errorbar"></a></dt>
<dd><p>The function that computes the error bar. Should be "CI" or "SE" or
any function name if you defined a custom function. Default to "CI"</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>The coverage factor; necessary when <code>errorbar == "CI"</code>. Default is 0.95.</p></dd>


<dt id="arg-adjustments">adjustments<a class="anchor" aria-label="anchor" href="#arg-adjustments"></a></dt>
<dd><p>List of adjustments as described below.
Default is <code>adjustments = list(purpose = "single", popSize = Inf,  decorrelation = "none", samplingDesign = "SRS")</code></p></dd>


<dt id="arg-showplot">showPlot<a class="anchor" aria-label="anchor" href="#arg-showplot"></a></dt>
<dd><p>Defaults to TRUE. Set to FALSE if you want the output to be the summary
statistics and intervals.</p></dd>


<dt id="arg-plotstyle">plotStyle<a class="anchor" aria-label="anchor" href="#arg-plotstyle"></a></dt>
<dd><p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated" class="external-link"><img src="figures/lifecycle-deprecated.svg" alt="[Deprecated]"></a></p></dd>


<dt id="arg-plotlayout">plotLayout<a class="anchor" aria-label="anchor" href="#arg-plotlayout"></a></dt>
<dd><p>The type of object to plot on the graph. See full list below.
Defaults to "line".</p></dd>


<dt id="arg-preprocessfct">preprocessfct<a class="anchor" aria-label="anchor" href="#arg-preprocessfct"></a></dt>
<dd><p>is a transform (or vector of) to be performed first on data
matrix of each group</p></dd>


<dt id="arg-postprocessfct">postprocessfct<a class="anchor" aria-label="anchor" href="#arg-postprocessfct"></a></dt>
<dd><p>is a transform (or vector of)</p></dd>


<dt id="arg-clustercolumn">clusterColumn<a class="anchor" aria-label="anchor" href="#arg-clustercolumn"></a></dt>
<dd><p>used in conjunction with samplingDesign = "CRS", indicates which column
contains the cluster membership</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>In addition to the parameters above, superbPlot also accept a number of
optional arguments that will be transmitted to the plotting function, such as
pointParams (a list of ggplot2 parameters to input inside geoms; see ?geom_bar2) and
errorbarParams (a list of ggplot2 parameters for geom_errorbar; see ?geom_errorbar)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>a plot with the correct error bars or a table of those summary statistics.
The plot is a ggplot2 object with can be modified with additional declarations.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The possible adjustements are the following</p><ul><li><p>popsize: Size of the population under study. Defaults to Inf</p></li>
<li><p>purpose: The purpose of the comparisons. Defaults to "single".
Can be "single", "difference", or "tryon".</p></li>
<li><p>decorrelation: Decorrelation method for repeated measure designs.
Chooses among the methods "CM", "LM", "CA", "UA", "LDr" (with r an integer) or "none".
Defaults to "none". "CA" is correlation-adjusted c19superb;
"CM" is Cousineau-Morey b12superb; "LM" is Loftus and Masson
lm94superb;
"UA" is based on the unitary Alpha method (derived from the Cronbach alpha;
see lc22superb).
"LDr" is local decorrelation (useful for long time series with autoregressive
correlation structures; see cppf24superb).</p></li>
<li><p>samplingDesign: Sampling method to obtain the sample. implemented
sampling is "SRS" (Simple Randomize Sampling) and "CRS"
(Cluster-Randomized Sampling).</p></li>
</ul><p>The formulas can be for long format data using | notation, e.g.,</p><ul><li><p><code>superb( extra ~ group | ID, sleep )</code></p></li>
</ul><p>or for wide format, using cbind() or crange() notation, e.g.,</p><ul><li><p><code>superb( cbind(DV.1.1, DV.2.1,DV.1.2, DV.2.2,DV.1.3, DV.2.3) ~ . , dta, WSFactors = c("a(2)","b(3)"))</code></p></li>
<li><p><code>superb( crange(DV.1.1, DV.2.3) ~ . , dta, WSFactors = c("a(2)","b(3)"))</code></p></li>
</ul><p>The layouts for plots are the following:</p><ul><li><p>These are basic plots:</p><ul><li><p>"bar" Shows the summary statistics with bars and error bars;</p></li>
<li><p>"line" Shows the summary statistics with lines connecting the conditions
over the first factor;</p></li>
<li><p>"point" Shows the summary statistics with isolated points</p></li>
<li><p>"lineband" illustrates the confidence intervals as a band;</p></li>
</ul></li>
<li><p>These plots add distributional information in addition</p><ul><li><p>"pointjitter" Shows the summary statistics along with jittered points depicting
the raw data;</p></li>
<li><p>"pointjitterviolin" Also adds violin plots to the previous layout</p></li>
<li><p>"pointindividualline" Connects the raw data with line along the first factor
(which should be a repeated-measure factor)</p></li>
<li><p>"raincloud" Illustrates the distribution with a cloud (half_violin_plot) and
jittered dots next to it. Looks better when coordinates are
flipped <code>+coord_flip()</code></p></li>
<li><p>"corset" illustrates within-subject designs with individual lines and clouds.</p></li>
</ul></li>
<li><p>Circular plots (aka radar plots) results from the following layouts:</p><ul><li><p>"circularpoint" Shows the summary statistics with isolated points</p></li>
<li><p>"circularline" Shows the summary statistics with lines;</p></li>
<li><p>"circularlineband" Also adds error bands instead of error bars;</p></li>
<li><p>"circularpointjitter" Shows summary statistics and error bars but also jittered dots;</p></li>
<li><p>"circularpointlinejitter" Same as previous layout, but connect the points with lines.
New layouts are added from times to time.
Personalized layouts can also be created (see Vignette5).</p></li>
</ul></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic example using a built-in dataframe as data. </span></span></span>
<span class="r-in"><span><span class="co"># By default, the mean is computed and the error bar are 95% confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span> <span class="op">+</span> <span class="va">supp</span>, <span class="va">ToothGrowth</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="superb-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example changing the summary statistics to the median and</span></span></span>
<span class="r-in"><span><span class="co"># the error bar to 80% confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span> <span class="op">+</span> <span class="va">supp</span>, <span class="va">ToothGrowth</span>,</span></span>
<span class="r-in"><span>       statistic <span class="op">=</span> <span class="st">"median"</span>, errorbar <span class="op">=</span> <span class="st">"CI"</span>, gamma <span class="op">=</span> <span class="fl">.80</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="superb-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example introducing adjustments for pairwise comparisons </span></span></span>
<span class="r-in"><span><span class="co"># and assuming that the whole population is limited to 200 persons</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span> <span class="op">+</span> <span class="va">supp</span>, <span class="va">ToothGrowth</span>,  </span></span>
<span class="r-in"><span>  adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> purpose <span class="op">=</span> <span class="st">"difference"</span>, popSize <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="superb-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This example adds ggplot directives to the plot produced</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span><span class="va">len</span> <span class="op">~</span> <span class="va">dose</span> <span class="op">+</span> <span class="va">supp</span>, <span class="va">ToothGrowth</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Dose"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Tooth Growth"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="superb-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The following examples are based on repeated measures</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>superb.feedback <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="co"># shut down 'warnings' and 'design' interpretation messages</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A simple example: The sleep data</span></span></span>
<span class="r-in"><span><span class="co"># The sleep data are paired data showing the additional time of sleep with </span></span></span>
<span class="r-in"><span><span class="co"># the soporific drug #1 (("group = 1") and with the soporific drug #2 ("group = 2"). </span></span></span>
<span class="r-in"><span><span class="co"># There is 10 participants with two measurements.</span></span></span>
<span class="r-in"><span><span class="co"># sleep is available in long format </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Makes the plots first without decorrelation:</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span> <span class="va">extra</span> <span class="op">~</span> <span class="va">group</span> <span class="op">|</span> <span class="va">ID</span>, <span class="va">sleep</span> <span class="op">)</span></span></span>
<span class="r-plt img"><img src="superb-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># As seen the error bar are very long. Lets take into consideration correlation...</span></span></span>
<span class="r-in"><span><span class="co"># ...  with decorrelation (technique Correlation-adjusted CA):</span></span></span>
<span class="r-in"><span><span class="fu">superb</span><span class="op">(</span><span class="va">extra</span> <span class="op">~</span> <span class="va">group</span> <span class="op">|</span> <span class="va">ID</span>, <span class="va">sleep</span>, </span></span>
<span class="r-in"><span>  <span class="co"># only difference:</span></span></span>
<span class="r-in"><span>  adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="superb-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># The error bars shortened as the correlation is substantial (r = .795).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Another example: The Orange data</span></span></span>
<span class="r-in"><span><span class="co"># This example contains 5 trees whose diameter (in mm) has been measured at various age (in days):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Orange</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Makes the plots first without decorrelation:</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">superb</span><span class="op">(</span> <span class="va">circumference</span> <span class="op">~</span> <span class="va">age</span> <span class="op">|</span> <span class="va">Tree</span>, <span class="va">Orange</span>,</span></span>
<span class="r-in"><span>  adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Age level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Trunk diameter (mm)"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"''Standalone'' confidence intervals"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... and then with decorrelation (technique Correlation-adjusted CA):</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">superb</span><span class="op">(</span> <span class="va">circumference</span> <span class="op">~</span> <span class="va">age</span> <span class="op">|</span> <span class="va">Tree</span>, <span class="va">Orange</span>,</span></span>
<span class="r-in"><span>  adjustments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>purpose <span class="op">=</span> <span class="st">"difference"</span>, decorrelation <span class="op">=</span> <span class="st">"CA"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"Age level"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Trunk diameter (mm)"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span> ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">250</span><span class="op">)</span> <span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="st">"Decorrelated confidence intervals"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can present both plots side-by-side</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="superb-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">######################################################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Denis Cousineau.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

